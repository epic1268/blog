<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>27__命令行：不只是酷，更重要的是能提高个人效能 - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="你好，我是葛俊。今天，我要与你分享的主题是，命令行下的高效工作技巧。
我先和你讲一个有意思的话题吧。命令行工具常常会给人一种黑客的感觉，好莱坞的电影里面常常出现命令行窗口的使用。不知道你听说过没有，很多好莱坞电影在拍摄时使用的其实是一个叫作nmap的工具。这个工具是做安全扫描的，只不过因为它的显示特别花哨，所以被很多电影采用。在 nmap 官方网站上，还专门列出来了这些电影的名单。
" /><meta name="keywords" content="技术文档, docs, 极客时间" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/27__%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8D%E5%8F%AA%E6%98%AF%E9%85%B7%E6%9B%B4%E9%87%8D%E8%A6%81%E7%9A%84%E6%98%AF%E8%83%BD%E6%8F%90%E9%AB%98%E4%B8%AA%E4%BA%BA%E6%95%88%E8%83%BD/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/27__%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8D%E5%8F%AA%E6%98%AF%E9%85%B7%E6%9B%B4%E9%87%8D%E8%A6%81%E7%9A%84%E6%98%AF%E8%83%BD%E6%8F%90%E9%AB%98%E4%B8%AA%E4%BA%BA%E6%95%88%E8%83%BD/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="27__命令行：不只是酷，更重要的是能提高个人效能">
  <meta property="og:description" content="你好，我是葛俊。今天，我要与你分享的主题是，命令行下的高效工作技巧。
我先和你讲一个有意思的话题吧。命令行工具常常会给人一种黑客的感觉，好莱坞的电影里面常常出现命令行窗口的使用。不知道你听说过没有，很多好莱坞电影在拍摄时使用的其实是一个叫作nmap的工具。这个工具是做安全扫描的，只不过因为它的显示特别花哨，所以被很多电影采用。在 nmap 官方网站上，还专门列出来了这些电影的名单。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="研发效率破局之道">

  <meta itemprop="name" content="27__命令行：不只是酷，更重要的是能提高个人效能">
  <meta itemprop="description" content="你好，我是葛俊。今天，我要与你分享的主题是，命令行下的高效工作技巧。
我先和你讲一个有意思的话题吧。命令行工具常常会给人一种黑客的感觉，好莱坞的电影里面常常出现命令行窗口的使用。不知道你听说过没有，很多好莱坞电影在拍摄时使用的其实是一个叫作nmap的工具。这个工具是做安全扫描的，只不过因为它的显示特别花哨，所以被很多电影采用。在 nmap 官方网站上，还专门列出来了这些电影的名单。">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="4958">
  <meta itemprop="keywords" content="研发效率破局之道">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="27__命令行：不只是酷，更重要的是能提高个人效能">
  <meta name="twitter:description" content="你好，我是葛俊。今天，我要与你分享的主题是，命令行下的高效工作技巧。
我先和你讲一个有意思的话题吧。命令行工具常常会给人一种黑客的感觉，好莱坞的电影里面常常出现命令行窗口的使用。不知道你听说过没有，很多好莱坞电影在拍摄时使用的其实是一个叫作nmap的工具。这个工具是做安全扫描的，只不过因为它的显示特别花哨，所以被很多电影采用。在 nmap 官方网站上，还专门列出来了这些电影的名单。">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">27__命令行：不只是酷，更重要的是能提高个人效能</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> 极客时间 </a>
            </div>
          <span class="more-meta"> 约 4958 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#为什么要使用命令行">为什么要使用命令行？</a></li>
        <li><a href="#第一步选择模拟终端">第一步，选择模拟终端</a></li>
        <li><a href="#第二步选择-shell">第二步，选择 Shell</a></li>
        <li><a href="#第三步具体的-shell-配置">第三步，具体的 Shell 配置</a></li>
        <li><a href="#文件-homebashterm_colors定义颜色">文件 $HOME/.bash/term_colors，定义颜色</a></li>
      </ul>
    </li>
    <li><a href="#basic-aliases-for-bash-terminal-colors">Basic aliases for bash terminal colors</a></li>
    <li><a href="#regular-colors">regular colors</a></li>
    <li><a href="#empahsized-bolded-colors">empahsized (bolded) colors</a></li>
    <li><a href="#background-colors">background colors</a>
      <ul>
        <li><a href="#文件-homebashrc设置提示符及其解释">文件 $HOME/.bashrc，设置提示符及其解释</a>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#set-up-the-prompt-colors">Set up the prompt colors</a></li>
    <li><a href="#1-the-time-shows-when-each-command-was-executed-when-i-get-back-to-my-terminal">(1) The time shows when each command was executed, when I get back to my terminal</a></li>
    <li><a href="#2-git-information-really-important-for-git-users">(2) Git information really important for git users</a></li>
    <li><a href="#3-prompt-color-is-red-if-im-root">(3) Prompt color is red if I&rsquo;m root</a></li>
    <li><a href="#4-the-last-part-of-the-prompt-can-copypaste-directly-into-an-scp-command">(4) The last part of the prompt can copy/paste directly into an SCP command</a></li>
    <li><a href="#5-color-highlight-out-the-current-directory-because-its-important">(5) Color highlight out the current directory because it&rsquo;s important</a></li>
    <li><a href="#6-the-export-ps1-is-simple-to-understand">(6) The export PS1 is simple to understand!</a></li>
    <li><a href="#7-if-the-prev-command-error-codes-the-prompt--turns-red">(7) If the prev command error codes, the prompt &lsquo;&gt;&rsquo; turns red</a>
      <ul>
        <li><a href="#git-alias">git alias</a></li>
        <li><a href="#ls-aliases">ls aliases</a></li>
        <li><a href="#git-completion请参考-httpsgithubcomgitgitblobmastercontribcompletiongit-completionbash">git completion，请参考 <a href="https://github.com/git/git/blob/master/contrib/completion/git-completion.bash">https://github.com/git/git/blob/master/contrib/completion/git-completion.bash</a></a></li>
        <li><a href="#文件zshrcsh-中关-oh-my-zsh-的插件列表具体插件细节请参考-httpsgithubcomrobbyrusselloh-my-zsh以及使用-web-搜索查询">文件~/.zshrc.sh 中关 oh-my-zsh 的插件列表，具体插件细节请参考 <a href="https://github.com/robbyrussell/oh-my-zsh">https://github.com/robbyrussell/oh-my-zsh</a>，以及使用 Web 搜索查询</a></li>
        <li><a href="#我使用的是-bobthefish-主题">我使用的是 bobthefish 主题</a></li>
        <li><a href="#第四步远程-ssh-的处理">第四步，远程 SSH 的处理</a></li>
        <li><a href="#小结">小结</a></li>
        <li><a href="#思考题">思考题</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>你好，我是葛俊。今天，我要与你分享的主题是，命令行下的高效工作技巧。</p>
<p>我先和你讲一个有意思的话题吧。命令行工具常常会给人一种黑客的感觉，好莱坞的电影里面常常出现命令行窗口的使用。不知道你听说过没有，很多好莱坞电影在拍摄时使用的其实是一个叫作nmap的工具。这个工具是做安全扫描的，只不过因为它的显示特别花哨，所以被很多电影采用。在 nmap 官方网站上，还专门列出来了这些电影的名单。</p>
<p>类似这种可以让自己看起来很忙的工具还有很多，比如Genact。下面是一个使用 Genact 的录屏，当然这里的命令并没有真正运行。这可能是整个专栏中，唯一一个让你看起来效率很高，实际上却是降低效率的工具，但说不定对你有用，你懂的。</p>
<p>讲完这个娱乐性的话题，我们进入正题吧。</p>
<h2 id="为什么要使用命令行">为什么要使用命令行？</h2>
<p>GUI 图形界面的出现是计算机技术的变革，极大方便了用户。但在这么多年后的今天，命令行工具为什么仍然有如此强大的生命力呢？</p>
<p>在我看来，对软件工程师来说，想要高效开发就必须掌握命令行，主要原因包括：</p>
<ol>
<li>虽然鼠标的移动和点击比较直观，但要完成重复性的工作，使用键盘会快捷得多。这一点从超市的结算人员就可以看出来，使用键盘系统的收银员总是噼里啪啦地很快就可以完成结算，而使用鼠标点击的话明显慢很多。</li>
<li>作为开发人员，可以比较容易地使用命令行的脚本，对自己的工作进行自动化，以及和其他系统工具联动。但使用 GUI 的话，就会困难得多。</li>
<li>命令行通常可以暴露更完整的功能，让使用者对整个系统有更透彻的理解。Git 就是一个典型的例子，再好的 GUI Git 系统都只能封装一部分 Git 命令行功能，要想真正了解 Git，我们必须要使用命令行。</li>
<li>有一些情况是必须使用命令行的，比如 SSH 到远程服务器上工作的时候。</li>
</ol>
<p>为了演示命令行的强大功能给我们带来的方便，下面是一个在本地查看文件并上传到服务器的流程的录屏。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/d5d747c86e2885f1795c57172a2de6b1.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/43c473602df30492593db37e420f35c2.png" alt=""></p>
<p>通过这个案例，你可以看到命令行的以下几个功能：</p>
<ol>
<li>在提示行会高亮显示时间、机器名、用户名、Git 代码仓的分支和状态，以及上一个命令的完成状态。</li>
<li>输入命令的时候，高亮显示错误并自动纠错。</li>
<li>使用交互的形式进行文件夹的跳转，并方便查找文件，还可以直接在命令行里显示图片。</li>
<li>使用交互的工具，把文件上传到远端的服务器，并快速连接到远端查看传输是否成功。</li>
</ol>
<p>整个流程全部都是在命令行里完成的，速度非常快，用户体验也非常好。正因为如此，我看到的硅谷特别高效的开发人员，绝大多数都大量使用命令行。那，面对成百上千的命令行工具，我们<strong>怎样才能高效地学习和使用</strong>呢？</p>
<p>我将高效学习使用命令行的过程，归纳为两大步：</p>
<ol>
<li>配置好环境；</li>
<li>针对自己最常使用命令行的场景，有的放矢地选择工具。</li>
</ol>
<p>今天，我就与你详细讲述<strong>环境配置</strong>这个话题。而关于选择工具的话题，我会在下一篇文章中与你详细介绍。总结来讲，环境配置主要包括以下四步：</p>
<ol>
<li>选择模拟终端；</li>
<li>选择 Shell；</li>
<li>具体的 Shell 配置；</li>
<li>远程 SSH 的处理。</li>
</ol>
<p>这里需要注意的是，在命令行方面，macOS 和 Linux 系统比 Windows 系统要强大许多，所以我主要以 macOS 和 Linux 系统来介绍，而关于 Windows 的环境配置，我只会捎带提一下。不过，macOS 和 Linux 系统中的工具选择和配置思路，你可以借鉴到 Windows 系统中。</p>
<h2 id="第一步选择模拟终端">第一步，选择模拟终端</h2>
<p>我将一个好的终端应该具有的特征，归纳为 4 个：</p>
<ol>
<li>快，稳定；</li>
<li>支持多终端，比如可以方便地水平和纵向分屏，有 tab 等；</li>
<li>方便配置字体颜色等；</li>
<li>方便管理常用 SSH 的登录。</li>
</ol>
<p>macOS 系统自带的终端不太好用，常见的替代工具有 iTerm2、Terminator、Hyper 和 Upterm。我平时使用的 iTerm2，是一个免费软件，功能强大，具备上面提到的 4 个特征。下面我就以 iTerm2 为例展开介绍。其他几个工具上也有类似功能，所以你不必担心。</p>
<p>在多终端的场景方面，iTerm2 支持多窗口、多标签页，同一窗口中可以进行多次水平和纵向分屏。这些操作以及窗口的跳转都有快捷键支持，你可以很方便地在网络上搜索到。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/f3b7ae6b35d6130f3b8fa510f752d5a9.png" alt=""></p>
<p>在管理常用 SSH 的登录方面，iTerm2 使用 Profile（用户画像）来控制。比如，下面是一个连接到远程服务器案例的录屏。</p>
<p>可以看到，在我的工作环境里常会用到 4 个 Profile，其中有两个是连接到远端服务器的，包括 Mosh Remote Server 1 和 SSH Remote Server 2。工作时，我使用 Cmd+O，然后选择 Server 1 这个 Profile，就可以打开一个新窗口，连接到这个远程服务器上。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/88655b9d483f69bbd84cbc22b840c995.png" alt=""></p>
<p>每一个 Profile 都可以定义自己的字体、颜色、shell 命令等。比如，Server 1 是类生产服务器，我就把背景设置成了棕红色，提醒自己在这个机器上工作时一定要小心。所以在上面的录屏中你可以看到，连接到远端的 SSH 标签页，它的背景、标签页都是棕红色。另外，下面是如何对 Profile 颜色进行设置的截屏。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/d59cc2024407602c177ced1a3154827c.png" alt=""></p>
<p>除了这些基础功能外，iTerm2 还有很多贴心的设计。比如：</p>
<ol>
<li><strong>在屏幕中显示运行历史</strong>（Cmd+Opt+B/F）。有些情况下，向上滚动终端并不能看到之前的历史，比如运行 VIM 或者 Tmux 的时候。这时，浏览显示历史就特别有用了。</li>
<li><strong>高亮显示当前编辑位置</strong>，包括高亮显示当前行（Cmd+Opt+；）高亮显示光标所在位置（Cmd+/）。</li>
<li><strong>与上一次运行命令相关的操作</strong>，包括显示上一次运行命令的地方（Cmd+Shift+up），选中上一个命令的输出（Cmd+Shift+A）。</li>
</ol>
<p>其中第 2、3 项功能是由一组macOS 的集成工具提供的。这个工具集还包括显示图片的命令 imgls、imgcat，显示自动补全命令，显示时间、注释，以及在主窗口旁显示额外信息等。这些设计虽然很小，但非常实用。</p>
<p>关于 Windows 系统，2019 年 5 月微软推出了Windows Terminal，支持多 Tab，定制性很强，据说体验很不错。</p>
<p>选择好了终端，环境设置的第二步就是选择 Shell。</p>
<h2 id="第二步选择-shell">第二步，选择 Shell</h2>
<p>在我看来，选择 Shell 主要有普遍性和易用性这两条原则。</p>
<p>Linux/Unix 系统下，<strong>Bash</strong>最普遍、用户群最广，但是易用性不是很好。常用来替代 Bash 的工具有<strong>Zsh</strong>和<strong>Fish</strong>，它们的易用性都很好。下面是两张图片，用于展示 Zsh 和 Fish 在易用性方面的一些功能。</p>
<p>Zsh：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/d947652db3f5130f44850fc0e26efc64.png" alt=""></p>
<p>Fish：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/3f8a105d4e4ca80e6c1a12be3ed738fa.png" alt=""></p>
<p>我个人觉得 Fish 比 Zsh 更方便。事实上，Fish 是 Friendly Interactive Shell 的简称。所以，交互是 Fish 的强项。可惜的是，Fish 不严格遵循 POSIX 的语法，与 Bash 的脚本不兼容，而 Zsh 则兼容，所以我目前主要使用的是 Zsh。</p>
<p>选好了模拟终端和 Shell 之后，便是配置环境的第三步，具体的 Shell 配置了。</p>
<h2 id="第三步具体的-shell-配置">第三步，具体的 Shell 配置</h2>
<p>接下来，我以我自己使用的设置为例，向你介绍 Bash、Zsh、Fish 的具体配置吧。这里，主要包括<strong>命令行提示符</strong>的配置和其他配置两个方面。</p>
<p>之所以把命令行提示符单独提出来，是因为它一直展现在界面上，能提供很有用的价值，对命令行高效工作至关重要。下面是一张图片，展示了 Bash、Zsh 和 Fish 的命令行提示符。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/198cadc9fadf44d1e06f27ec924fbb7c.png" alt=""></p>
<p>这个窗口分为三部分，最上面是 Bash，中间是 Zsh，最下面是 Fish，都配置了文件路径、Git 信息和时间戳等信息。接下来，我带你一起看看这 3 个工具应该如何配置吧。</p>
<p>**Bash 比较麻烦，**配置文件包括定义颜色和命令行提示符的两部分：</p>
<h2 id="文件-homebashterm_colors定义颜色">文件 $HOME/.bash/term_colors，定义颜色</h2>
<h1 id="basic-aliases-for-bash-terminal-colors">Basic aliases for bash terminal colors</h1>
<p>N=&quot;[\033[0m]&quot;    # unsets color to term&rsquo;s fg color</p>
<h1 id="regular-colors">regular colors</h1>
<p>K=&quot;[\033[0;30m]&quot;    # black<br>
R=&quot;[\033[0;31m]&quot;    # red<br>
G=&quot;[\033[0;32m]&quot;    # green<br>
Y=&quot;[\033[0;33m]&quot;    # yellow<br>
B=&quot;[\033[0;34m]&quot;    # blue<br>
M=&quot;[\033[0;35m]&quot;    # magenta<br>
C=&quot;[\033[0;36m]&quot;    # cyan<br>
W=&quot;[\033[0;37m]&quot;    # white</p>
<h1 id="empahsized-bolded-colors">empahsized (bolded) colors</h1>
<p>MK=&quot;[\033[1;30m]&quot;<br>
MR=&quot;[\033[1;31m]&quot;<br>
MG=&quot;[\033[1;32m]&quot;<br>
MY=&quot;[\033[1;33m]&quot;<br>
MB=&quot;[\033[1;34m]&quot;<br>
MM=&quot;[\033[1;35m]&quot;<br>
MC=&quot;[\033[1;36m]&quot;<br>
MW=&quot;[\033[1;37m]&quot;</p>
<h1 id="background-colors">background colors</h1>
<p>BGK=&quot;[\033[40m]&quot;<br>
BGR=&quot;[\033[41m]&quot;<br>
BGG=&quot;[\033[42m]&quot;<br>
BGY=&quot;[\033[43m]&quot;<br>
BGB=&quot;[\033[44m]&quot;<br>
BGM=&quot;[\033[45m]&quot;<br>
BGC=&quot;[\033[46m]&quot;<br>
BGW=&quot;[\033[47m]&quot;</p>
<h2 id="文件-homebashrc设置提示符及其解释">文件 $HOME/.bashrc，设置提示符及其解释</h2>
<h6 id="prompt">PROMPT</h6>
<h1 id="set-up-the-prompt-colors">Set up the prompt colors</h1>
<p>source $HOME/.bash/term_colors<br>
PROMPT_COLOR=$G<br>
if [ ${UID} -eq 0 ]; then<br>
PROMPT_COLOR=$R ### root is a red color prompt<br>
fi</p>
<p>#t Some good thing about this prompt:</p>
<h1 id="1-the-time-shows-when-each-command-was-executed-when-i-get-back-to-my-terminal">(1) The time shows when each command was executed, when I get back to my terminal</h1>
<h1 id="2-git-information-really-important-for-git-users">(2) Git information really important for git users</h1>
<h1 id="3-prompt-color-is-red-if-im-root">(3) Prompt color is red if I&rsquo;m root</h1>
<h1 id="4-the-last-part-of-the-prompt-can-copypaste-directly-into-an-scp-command">(4) The last part of the prompt can copy/paste directly into an SCP command</h1>
<h1 id="5-color-highlight-out-the-current-directory-because-its-important">(5) Color highlight out the current directory because it&rsquo;s important</h1>
<h1 id="6-the-export-ps1-is-simple-to-understand">(6) The export PS1 is simple to understand!</h1>
<h1 id="7-if-the-prev-command-error-codes-the-prompt--turns-red">(7) If the prev command error codes, the prompt &lsquo;&gt;&rsquo; turns red</h1>
<p>export PS1=&quot;\e[42m\t\e[m$N $W&quot;&rsquo;$(__git_ps1 &ldquo;(%s) &ldquo;)&rsquo;&quot;$N$PROMPT_COLOR\u@\H$N:$C\w$N\n[&rdquo;&rsquo;$CURSOR_COLOR&rsquo;&rdquo;]&gt;$W &quot;<br>
export PROMPT_COMMAND=&lsquo;if [ $? -ne 0 ]; then CURSOR_COLOR=<code>echo -e &quot;\033[0;31m&quot;</code>; else CURSOR_COLOR=&quot;&quot;; fi;&rsquo;</p>
<p>命令行提示符之外的其他方面的配置，在 Bash 方面，我主要设置了一些命令行补全（completion）和别名设置（alias）：</p>
<h2 id="git-alias">git alias</h2>
<p>alias g=git<br>
alias gro=&lsquo;git r origin/master&rsquo;<br>
alias grio=&lsquo;git r -i origin/master&rsquo;<br>
alias gric=&lsquo;git r &ndash;continue&rsquo;<br>
alias gria=&lsquo;git r &ndash;abort&rsquo;</p>
<h2 id="ls-aliases">ls aliases</h2>
<p>alias ls=&lsquo;ls -G&rsquo;<br>
alias la=&lsquo;ls -la&rsquo;<br>
alias ll=&lsquo;ls -l&rsquo;</p>
<h2 id="git-completion请参考-httpsgithubcomgitgitblobmastercontribcompletiongit-completionbash">git completion，请参考 <a href="https://github.com/git/git/blob/master/contrib/completion/git-completion.bash">https://github.com/git/git/blob/master/contrib/completion/git-completion.bash</a></h2>
<p>source ~/.git-completion.bash</p>
<p><strong>Zsh 的配置就容易得多了，而且是模块化的</strong>。基本上就是安装一个配置的框架，然后选择插件和主题即可。具体来说，我的 Zsh 命令行提示符配置步骤包括以下三步。</p>
<p>第一，安装 oh-my-zsh。这是一个对 Zsh 进行配置的常用开源框架。</p>
<p>brew install zsh</p>
<p>第二，安装 powerline 字体，供下一步使用。</p>
<p>brew install powerlevel9k</p>
<p>第三，在~/.zshrc 中配置 ZSH_THEME，指定使用 powerlevel9k 这个主题。</p>
<p>ZSH_THEME=&ldquo;powerlevel9k/powerlevel9k&rdquo;</p>
<p>命令行提示符以外的其他配置，主要是通过安装和使用 oh-my-zsh 插件的方式来完成。下面是我使用的各种插件，供你参考。</p>
<h2 id="文件zshrcsh-中关-oh-my-zsh-的插件列表具体插件细节请参考-httpsgithubcomrobbyrusselloh-my-zsh以及使用-web-搜索查询">文件~/.zshrc.sh 中关 oh-my-zsh 的插件列表，具体插件细节请参考 <a href="https://github.com/robbyrussell/oh-my-zsh">https://github.com/robbyrussell/oh-my-zsh</a>，以及使用 Web 搜索查询</h2>
<p>plugins=(<br>
git<br>
z<br>
vi-mode<br>
zsh-syntax-highlighting<br>
zsh-autosuggestions<br>
osx<br>
colored-man-pages<br>
catimg<br>
web-search<br>
vscode<br>
docker<br>
docker-compose<br>
copydir<br>
copyfile<br>
npm<br>
yarn<br>
extract<br>
fzf-z<br>
)</p>
<p>source $ZSH/oh-my-zsh.sh</p>
<p>**至于 Fish 的配置，和 Zsh 差不多，也是安装一个配置的框架，然后选择插件和主题即可。**在配置命令行提示符时，主要步骤包括以下两步。</p>
<p>第一，安装配置管理框架 oh-my-fish：</p>
<p>curl -L <a href="https://get.oh-my.fish">https://get.oh-my.fish</a> | fish</p>
<p>第二，查看、安装、使用 oh-my-fish 的某个主题，主题会自动配置好命令行提示符：</p>
<p>omf theme<br>
omf install <theme><br>
omf theme <theme></p>
<h2 id="我使用的是-bobthefish-主题">我使用的是 bobthefish 主题</h2>
<p>omf theme bobthefish</p>
<p>这里有一篇不错的关于使用 oh-my-fish 配置的文章，供你参考。</p>
<p>Fish 的其他方面的配置，也是使用 oh-my-fish 配置会比较方便。关于具体的配置方法，建议你参照官方文档。</p>
<p>关于环境的最后一个配置，是远程 SSH 的处理。</p>
<h2 id="第四步远程-ssh-的处理">第四步，远程 SSH 的处理</h2>
<p>SSH 到其他机器，是开发人员的常见操作，最大的痛点是，怎样保持多次连接的持久性。也就是说，连接断开以后，远端的 SSH 进程被杀死，之前的工作记录、状态丢失，导致下一次连接进去需要重新设置，交易花销太大。有两类工具可以很好地解决这个问题。</p>
<p><strong>第一类工具是 Tmux 或者 Screen</strong>，这两个工具比较常见，用来管理一组窗口。</p>
<p>接下来，我以 Tmux 为例，与你描述其工作流程：首先 SSH 到远程服务器，然后用远程机器上的 Tmux Client 连接到已经运行的 Tmux Session 上。SSH 断开之后，Tmux Client 被杀死，但 Tmux Session 仍然保持运行，意味着命令的运行状态继续存在，下次 SSH 过去再使用 Tmux Client 连接即可。</p>
<p>如果你想深入了解 Tmux 的概念和搭建过程，可以参考这篇文章。</p>
<p><strong>第二类是一个保持连接不中断的工具，移动 Shell</strong>（Mobile Shell）。这也是我目前唯一见到的一个。这个工具是 MIT 做出来的，知道的人不多，是针对移动设备的网络经常断开设计的。</p>
<p>它的具体原理是，每次初始登录使用 SSH，之后就不再使用 SSH 了，而是使用一个基于 UDP 的 SSP 协议，能够在网络断开重连的时候自动重新连接，所以从使用者的角度来看就像从来没有断开过一样。</p>
<p>接下来，<strong>我以阿里云 ECS 主机、运行 Ubuntu18.04 为例，与你分享 Mosh+Tumx 的具体安装和设置方法。</strong></p>
<p>第一，服务器端安装并运行 Mosh Server。</p>
<p>junge@iZ4i3zrhuhpdbhZ:~$ sudo apt-get install mosh</p>
<p>第二，打开服务器上的 UDP 端口 60000~61000。</p>
<p>junge@iZ4i3zrhuhpdbhZ:~$ sudo ufw allow 60000:61000/udp</p>
<p>第三，在阿里云的 Web 界面上修改主机的安全组设置，允许 UDP 端口 60000~61000。</p>
<p><img src="./070e8ed6a7fa0e32871448d6608b0bbd.png.md" alt=""></p>
<p>第四，在客户端（比如 Mac 上），安装 Mosh Client。</p>
<p>jasonge@Juns-MacBook-Pro-2@l$ brew isntall mosh</p>
<p>第五，客户端使用 Mosh，用与 SSH 一样的命令行连接到服务器。</p>
<p>jasonge@Juns-MacBook-Pro-2@l$ mosh junge@<server-ip-or-name></p>
<p>下面这个录屏演示的是，我日常工作中使用 Mosh + Tmux 的流程。期间我会断开无线网，你可以看到 Mosh 自动连接上了，就好像来没有断过一样。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/a76ca902bb96f1733826f7861c94d0d5.png" alt=""></p>
<h2 id="小结">小结</h2>
<p>今天，我与你分享的是使用命令行工具工作时，涉及的环境配置问题。</p>
<p>首先，我与你介绍了选择模拟终端、选择和配置 Shell 的重要准则，并结合案例给出了具体的工具和配置方法，其中涉及的工具包括 iTerm2、Bash、Zsh、Fish 等。然后，我结合远程 SSH 这一常见工作场景，给出了使用 Tmux 和 Mosh 的优化建议。</p>
<p>掌握了关于环境配置的这些内容以后，在下一篇文章中，我将与你介绍具体命令行工具的选择和使用。</p>
<p>其实，我推荐开发者多使用命令行工具，并不是因为它们看起来炫酷，而是它们确实可以帮助我们节省时间、提高个人的研发效能。而高效使用命令行工具的前提，是配置好环境。</p>
<p>以 Mosh 为例，我最近经常会使用 iPad SSH 到远端服务器做一些开发工作。在这种移动开发的场景下，iPad 的网络经常断开，每次重新连接开销太大，基本上没办法工作。于是，我最终发现了 Mosh，并针对开发场景进行了设置。现在，每次我重新打开 iPad 的终端时，远程连接自动恢复，好像网络从没有断开过一样。这样一来，我就可以在移动端高效地开发了。</p>
<p>而对研发团队来说，如果能够对命令行工作环境进行优化和统一，毫无疑问会节省个人选择和配置工具的时间，进而提升团队的研发效能。</p>
<h2 id="思考题">思考题</h2>
<p>你觉得 Tmux 和 Screen 的最大区别是什么？是否有什么场景，我们必须使用其中的一个吗？</p>
<p>感谢你的收听，欢迎你在评论区给我留言分享你的观点，也欢迎你把这篇文章分享给更多的朋友一起阅读。我们下期再见！</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/6476358e731920fbc927e278bae473aa.png" alt=""></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%A0%94%E5%8F%91%E6%95%88%E7%8E%87%E7%A0%B4%E5%B1%80%E4%B9%8B%E9%81%93/">研发效率破局之道</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E9%9D%A2%E8%AF%95%E7%8E%B0%E5%9C%BA/27__%E9%9D%A2%E8%AF%95%E7%AD%94%E7%96%91%E4%BA%8C%E9%9D%A2%E8%AF%95%E9%97%AE%E7%AD%94%E7%8E%AF%E8%8A%82%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">27__面试答疑（二）：面试问答环节的一些思考</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/27__%E7%89%9B%E5%88%80%E5%B0%8F%E8%AF%95%E4%B8%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E7%9A%84%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/">
            <span class="next-text nav-default">27__牛刀小试（下）：实现一个自己的测试框架</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
