<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>12__问题集锦：详解正则常见问题及解决方案 - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="你好，我是伟忠。今天我来给你讲一讲，使用正则处理一些常见问题的方法。
问题处理思路 在讲解具体的问题前，我先来说一下使用正则处理问题的基本思路。有一些方法比较固定，比如将问题分解成多个小问题，每个小问题见招拆招：某个位置上可能有多个字符的话，就⽤字符组。某个位置上有多个字符串的话，就⽤多选结构。出现的次数不确定的话，就⽤量词。对出现的位置有要求的话，就⽤锚点锁定位置。
" /><meta name="keywords" content="技术文档, docs, 极客时间" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/12__%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6%E8%AF%A6%E8%A7%A3%E6%AD%A3%E5%88%99%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/12__%E9%97%AE%E9%A2%98%E9%9B%86%E9%94%A6%E8%AF%A6%E8%A7%A3%E6%AD%A3%E5%88%99%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="12__问题集锦：详解正则常见问题及解决方案">
  <meta property="og:description" content="你好，我是伟忠。今天我来给你讲一讲，使用正则处理一些常见问题的方法。
问题处理思路 在讲解具体的问题前，我先来说一下使用正则处理问题的基本思路。有一些方法比较固定，比如将问题分解成多个小问题，每个小问题见招拆招：某个位置上可能有多个字符的话，就⽤字符组。某个位置上有多个字符串的话，就⽤多选结构。出现的次数不确定的话，就⽤量词。对出现的位置有要求的话，就⽤锚点锁定位置。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="正则表达式入门课">

  <meta itemprop="name" content="12__问题集锦：详解正则常见问题及解决方案">
  <meta itemprop="description" content="你好，我是伟忠。今天我来给你讲一讲，使用正则处理一些常见问题的方法。
问题处理思路 在讲解具体的问题前，我先来说一下使用正则处理问题的基本思路。有一些方法比较固定，比如将问题分解成多个小问题，每个小问题见招拆招：某个位置上可能有多个字符的话，就⽤字符组。某个位置上有多个字符串的话，就⽤多选结构。出现的次数不确定的话，就⽤量词。对出现的位置有要求的话，就⽤锚点锁定位置。">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="5201">
  <meta itemprop="keywords" content="正则表达式入门课">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="12__问题集锦：详解正则常见问题及解决方案">
  <meta name="twitter:description" content="你好，我是伟忠。今天我来给你讲一讲，使用正则处理一些常见问题的方法。
问题处理思路 在讲解具体的问题前，我先来说一下使用正则处理问题的基本思路。有一些方法比较固定，比如将问题分解成多个小问题，每个小问题见招拆招：某个位置上可能有多个字符的话，就⽤字符组。某个位置上有多个字符串的话，就⽤多选结构。出现的次数不确定的话，就⽤量词。对出现的位置有要求的话，就⽤锚点锁定位置。">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">12__问题集锦：详解正则常见问题及解决方案</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> 极客时间 </a>
            </div>
          <span class="more-meta"> 约 5201 字 </span>
          <span class="more-meta"> 预计阅读 11 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#问题处理思路"><strong>问题处理思路</strong></a></li>
      </ul>
    </li>
    <li><a href="#提示-dd-代表右边不能是两个数字但它左边没有正则即为空字符串">提示 (?!\d\d) 代表右边不能是两个数字，但它左边没有正则，即为空字符串</a>
      <ul>
        <li><a href="#常见问题及解决方案">常见问题及解决方案</a></li>
      </ul>
    </li>
    <li><a href="#测试环境python3">测试环境，Python3</a>
      <ul>
        <li><a href="#总结">总结</a></li>
        <li><a href="#课后思考">课后思考</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>你好，我是伟忠。今天我来给你讲一讲，使用正则处理一些常见问题的方法。</p>
<h2 id="问题处理思路"><strong>问题处理思路</strong></h2>
<p>在讲解具体的问题前，我先来说一下使用正则处理问题的基本思路。有一些方法比较固定，比如将问题分解成多个小问题，每个小问题见招拆招：某个位置上可能有多个字符的话，就⽤字符组。某个位置上有多个字符串的话，就⽤多选结构。出现的次数不确定的话，就⽤量词。对出现的位置有要求的话，就⽤锚点锁定位置。</p>
<p>在正则中比较难的是某些字符不能出现，这个情况又可以进一步分为组成中不能出现，和要查找的内容前后不能出现。后一种用环视来解决就可以了。我们主要说一下第一种。</p>
<p>如果是要查找的内容中不能出现某些字符，这种情况比较简单，可以通过使用中括号来排除字符组，比如非元音字母可以使用 <code>[^aeiou]</code>来表示。</p>
<p>如果是内容中不能出现某个子串，比如要求密码是 6 位，且不能有连续两个数字出现。假设密码允许的范围是 \w，你应该可以想到使用 \w{6} 来表示 6 位密码，但如果里面不能有连续两个数字的话，该如何限制呢？这个可以环视来解决，就是每个字符的后面都不能是两个数字（要注意开头也不能是 \d\d），下面是使用 Python3 语言测试的示例。</p>
<blockquote>
<blockquote>
<blockquote>
<p>import re<br>
re.match(r&rsquo;^((?!\d\d)\w){6}$&rsquo;, &lsquo;11abcd&rsquo;)  # 不能匹配上</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="提示-dd-代表右边不能是两个数字但它左边没有正则即为空字符串">提示 (?!\d\d) 代表右边不能是两个数字，但它左边没有正则，即为空字符串</h1>
<blockquote>
<blockquote>
<blockquote>
<p>re.match(r&rsquo;^((?!\d\d)\w){6}$&rsquo;, &lsquo;1a2b3c&rsquo;)  # 能匹配上<br>
&lt;re.Match object; span=(0, 6), match=&lsquo;1a2b3c&rsquo;&gt;</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>re.match(r&rsquo;^(\w(?!\d\d)){6}$&rsquo;, &lsquo;11abcd&rsquo;)  # 错误正则示范                                                               <br>
&lt;re.Match object; span=(0, 6), match=&lsquo;11abcd&rsquo;&gt;</p>
</blockquote>
</blockquote>
</blockquote>
<p>在写完正则后，我们可以通过一些工具去调试，先要确保正则满足功能需求，再看一下有没有性能问题，如果功能不正确，性能考虑再多其实也没用。</p>
<h2 id="常见问题及解决方案">常见问题及解决方案</h2>
<ol>
<li><strong>匹配数字</strong></li>
</ol>
<p>数字的匹配比较简单，通过我们学习的字符组，量词等就可以轻松解决。</p>
<ol>
<li>数字在正则中可以使用 \d 或 [0-9] 来表示。</li>
<li>如果是连续的多个数字，可以使用 \d+ 或 [0-9]+。</li>
<li>如果 n 位数据，可以使用 \d{n}。</li>
<li>如果是至少 n 位数据，可以使用 \d{n,}。</li>
<li>如果是 m-n 位数字，可以使用 \d{m,n}。</li>
<li><strong>匹配正数、负数和小数</strong></li>
</ol>
<p>如果希望正则能匹配到比如 3，3.14，-3.3，+2.7 等数字，需要注意的是，开头的正负符号可能有，也可能没有，所以可以使用 [-+]? 来表示，小数点和后面的内容也不一定会有，所以可以使用 <code>(?:\.\d+)?</code> 来表示，因此匹配正数、负数和小数的正则可以写成 <code>[-+]?\d+(?:\.\d+)?</code>。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/5d7dbe8d73b4155ac674df17a7bac0f6.png" alt=""></p>
<p>非负整数，包含 0 和 正整数，可以表示成<code>[1-9]\d*|0</code>。</p>
<p>非正整数，包含 0 和 负整数，可以表示成<code>-[1-9]\d*|0</code>。</p>
<ol>
<li><strong>浮点数</strong></li>
</ol>
<p>这个问题你可能觉得比较简单，其中表示正负的符号和小数点可能有，也可能没有，直接用 <code>[-+]?\d+(?:\.\d+)?</code> 来表示。</p>
<p>如果我们考虑 .5 和 +.5 这样的写法，但一般不会有 -.5 这样的写法。正则又如何写呢？</p>
<p>我们可以把问题拆解，浮点数分为符号位、整数部分、小数点和小数部分，这些部分都有可能不存在，如果我们每个部分都加个问号，这样整个表达式可以匹配上空。</p>
<p>根据上面的提示，负号的时候整数部分不能没有，而正数的时候，整数部分可以没有，所以正则你可以将正负两种情况拆开，使用多选结构写成 <code>-?\d+(?:\.\d+)?|\+?(?:\d+(?:\.\d+)?|\.\d+)</code>（示例）。</p>
<p>这个可以拆分成两个问题：</p>
<p>负数浮点数表示：<code>-\d+(?:\.\d+)?</code><strong>。</strong></p>
<p>正数浮点数表示：<code>\+?(?:\d+(?:\.\d+)?|\.\d+)</code><strong>。</strong></p>
<ol>
<li><strong>十六进制数</strong></li>
</ol>
<p>十六进制的数字除了有 0-9 之外，还会有 a-f（或 A-F）代表 10 到 15 这 6 个数字，所以正则可以写成 <code>[0-9A-Fa-f]+</code>。</p>
<ol>
<li><strong>手机号码</strong></li>
</ol>
<p>手机号应该是比较常见的，手机号段比较复杂，如果要兼容所有的号段并不容易。目前来看，前四位是有一些限制，甚至 1740 和 1741 限制了前 5 位号段。</p>
<p>我们可以简单地使用字符组和多选分支，来准确地匹配手机号段。如果只限制前 2 位，可以表示成 <code>1[3-9]\d{9}</code>，如果想再精确些，限制到前三位，比如使用<code>1(?:3\d|4[5-9]|5[0-35-9]|6[2567]|7[0-8]|8\d|9[1389])\d{8}</code>来表示。如果想精确到 4 位，甚至 5 位，可以根据公开的号段信息自己来写一下，但要注意的是，越是精确，只要有新的号段，你就得改这个正则，维护起来会比较麻烦。另外，在实际运用的时候，你可能还要考虑一下有一些号码了 +86 或 0086 之类的前缀的情况。</p>
<p>手机号段的正则写起来其实写起来并不难，但麻烦的是后期的维护成本比较高，我之前就遇到过这种情况，买了一个 188 的移动号码，有不少系统在这个号段开放了挺长时间之后，还认为这个号段不合法。</p>
<p>目前公开的手机号段（图片来源）。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/4207cc8e96a655d93fc36a272d8f98b4.png" alt=""></p>
<ol>
<li><strong>身份证号码</strong></li>
</ol>
<p>我国的身份证号码是分两代的，第一代是 15 位，第二代是 18 位。如果是 18 位，最后一位可以是 X（或 x），两代开头都不能是 0，根据规则，你应该能很容易写出相应的正则，第一代可以用 [1-9]\d{14} 来表示，第二代比第一代多 3 位数据，可以使用量词 0 到 1 次，即写成</p>
<p><code>[1-9]\d{14}(\d\d[0-9Xx])?</code>。</p>
<ol>
<li><strong>邮政编码</strong></li>
</ol>
<p>邮编一般为 6 位数字，首位不是 0，比较简单，可以写成 <strong>[1-9]\d{5}</strong>，之前我们也提到过，6 位数字在其它情况下出现可能性也非常大，比如手机号的一部分，身份证号的一部分，所以如果是数据提取，一般需要添加断言，即写成 <code>(?&lt;!\d)[1-9]\d{5}(?!\d)</code>。</p>
<ol>
<li><strong>腾讯 QQ 号码</strong></li>
</ol>
<p>目前 QQ 号不能以 0 开头，最长的有 10 位，最短的从 10000（5 位）开始。从规则上我们可以得知，首位是 1-9，后面跟着是 4 到 9 位的数字，即可以使用 <strong>[1-9][0-9]{4,9}</strong> 来表示。</p>
<ol>
<li><strong>中文字符</strong></li>
</ol>
<p>中文属于多字节 Unicode 字符，之前我们讲过比如通过 Unicode 属性，但有一些语言是不支持这种属性的，可以通过另外一个办法，就是码值的范围，中文的范围是 4E00 - 9FFF 之间，这样可以覆盖日常使用大多数情况。</p>
<p>不同的语言是表示方式有一些差异，比如在 Python，Java，JavaScript 中，Unicode 可以写成 <code>\u码值</code> 来表示，即匹配中文的正则可以写成 [\u4E00-\u9FFF]，如果在 PHP 中使用，Unicode 就需要写成 <strong>\u{码值}</strong> 的样式。下面是在 Python3 语言中测试的示例，你可以参考一下。</p>
<h1 id="测试环境python3">测试环境，Python3</h1>
<blockquote>
<blockquote>
<blockquote>
<p>import re<br>
reg = re.compile(r&rsquo;[\u4E00-\u9FFF]&rsquo;)<br>
reg.findall(&ldquo;和伟忠一起学正则 regex&rdquo;)<br>
[&lsquo;和&rsquo;, &lsquo;伟&rsquo;, &lsquo;忠&rsquo;, &lsquo;一&rsquo;, &lsquo;起&rsquo;, &lsquo;学&rsquo;, &lsquo;正&rsquo;, &lsquo;则&rsquo;]</p>
</blockquote>
</blockquote>
</blockquote>
<ol>
<li><strong>IPv4 地址</strong></li>
</ol>
<p>IPv4 地址通常表示成 27.86.1.226 的样式，4 个数字用点隔开，每一位范围是 0-255，比如从日志中提取出 IP，如果不要求那么精确，一般使用 <code>\d{1,3}(\.\d{1,3}){3}</code>就够了，需要注意点号需要转义。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/3ffebb60e99d41989f5f188dd0e7ae8d.png" alt=""></p>
<p>如果我们想更精确地匹配，可以针对一到三位数分别考虑，一位数时可以表示成 <code>0{0,2}\d</code>，两位数时可以表示成 <code>0?[1-9]\d</code>，三位数时可以表示成 <code>1\d\d|2[0-4]\d|25[0-5]</code>，使用多选分支结构把他们写到一起，就是 <code>0{0,2}\d|0?[1-9]\d|1\d\d|2[0-4]\d|25[0-5]</code>这样。</p>
<p>这是表示出了 IPv4 地址中的一位（正则假设是 X），我们可以把 IPv4 表示成 X.X.X.X，可以使用量词，写成 (?:X.){3}X 或 X(?:.X){3}，由于 X 本身比较复杂，里面有多选分支结构，所以需要把它加上括号，所以 IPv4 的正则应该可以写成</p>
<p><code>(?:0{0,2}\d|0?[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(?:\.0{0,2}\d|0?[1-9]\d|1\d\d|2[0-4]\d|25[0-5]){3}</code>。</p>
<p>你以为这么写就对了么，如果你测试一下就发现，匹配行为很奇怪。（示例）</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/bc74d003e9feccce7400217cd0ed5863.png" alt=""></p>
<p>看到这个结果，你可能觉得太难了，不要担心，更不要放弃。其实我一开始也觉得这么写就可以了，我也需要测试，如果不符合预期，那就找到原因不断完善。</p>
<p>我们根据输出结果的表现，分析一下原因。原因主要有两点，都和多选分支结构有关系。我们想的是所有的一到三位数字前面都有一个点，重复三次，但点号和 0{0,2}\d 写到一起，意思是一位数字前面有点，两位和三位数前面没有点，所以需要使用括号把点挪出去，最终写成<code>(?:0{0,2}\d|0?[1-9]\d|1\d\d|2[0-4]\d|25[0-5])(?:\.(?:0{0,2}\d|0?[1-9]\d|1\d\d|2[0-4]\d|25[0-5])){3}</code>。</p>
<p>但经过测试，你会发现还是有问题，最后一个数字只匹配上了一位。（示例）</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/dd6c67e9cefc4778f3d2f9f094333202.png" alt=""></p>
<p>上一讲正则匹配原理中，我们讲解了 NFA 引擎在匹配多分支选择结构的时候，优先匹配最左边的，所以找到了一位数符合要求时，它就”急于“报告，并没有找出最长且符合要求的结果，这就要求我们在写多分支选择结构的时候，要把长的分支放左边，这样就可以解决问题了，即正则写成<code>(?:1\d\d|2[0-4]\d|25[0-5]|0?[1-9]\d|0{0,2}\d)(?:\.(?:1\d\d|2[0-4]\d|25[0-5]|0?[1-9]\d|0{0,2}\d)){3}</code>。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/813b1c4f6ceecb96c656699371a9a562.png" alt=""></p>
<p>在这个案例里，我们通过一步步推导，得到最终的答案。其实是想让你明白，你在写正则的时候，需要以什么样的分析思路来思考，最终如何解决问题，复杂的正则也很难一下子写出来，需要写完之后进行测试，在发现不符合预期后，不断进行完善。</p>
<p>在这里我还是想说一下，如果只是验证是不是合法的 IPv4 地址，可以直接使用点号切割，验证一下是不是四个部分，每个部分是不是在 0-255 之间就可以了，比使用正则来校验要简单很多，而且不容易出错。总之正则不是解决问题的唯一方法，我们要在合适的时候使用它，而不是说能用正则的都要用正则来解决。</p>
<ol>
<li><strong>日期和时间</strong></li>
</ol>
<p>假设日期格式是 yyyy-mm-dd，如果不那么严格，我们可以直接使用 \d{4}-\d{2}-\d{2}。如果再精确一些，比如月份是 1-12，当为一位的时候，前面可能不带 0，可以写成 01 或 1，月份使用正则，可以表示成 <code>1[0-2]|0?[1-9]</code>，日可能是 1-31，可以表示成 <code>[12]\d|3[01]|0?[1-9]</code>，这里需要注意的是 <code>0?[1-9]</code> 应该放在多选分支的最后面，因为放最前面，匹配上一位数字的时候就停止了（示例），正确的正则（示例）应该是 <code>\d{4}-(?:1[0-2]|0?[1-9])-(?:[12]\d|3[01]|0?[1-9])</code>。</p>
<p>时间格式比如是 23:34，如果是 24 小时制，小时是 0-23，分钟是 0-59，所以可以写成 <code>(?:2[0-3]|1\d|0?\d):(?:[1-5]\d|0?\d)</code>。12 小时制的也是类似的，你可以自己想一想怎么写。</p>
<p>另外，日期中月份还有大小月的问题，比如 2 月闰年可以是 29 日，使用正则没法验证日期是不是正确的。我们也不应该使用正则来完成所有事情，而是只使用正则来限制具体的格式，比如四位数字，两位数字之类的，提取到之后，使用日期时间相关的函数进行转换，如果失败就证明不是合法的日期时间。</p>
<ol>
<li><strong>邮箱</strong></li>
</ol>
<blockquote>
<p>邮箱示例：</p>
</blockquote>
<blockquote>
<p><a href="mailto:weizhong.tu2020@abc.com">weizhong.tu2020@abc.com</a></p>
</blockquote>
<blockquote>
<p><a href="mailto:12345@qq.com">12345@qq.com</a></p>
</blockquote>
<p>邮箱的组成是比较复杂的，格式是 用户名 @主机名，用户名部分通常可以有英文字母，数字，下划线，点等组成，但其中点不能在开头，也不能重复出现。根据 RFC5322 没有办法写出一个完美的正则，你可以参考一下这个网站。不过我们可以实现一些简体的版本，比如：<code>[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+</code>。</p>
<p>日常使用应该也够了。</p>
<ol>
<li><strong>网页标签</strong></li>
</ol>
<p>配对出现的标签，比如 title，一般网页标签不区分大小写，我们可以使用 <code>(?i)&lt;title&gt;.*?&lt;/title&gt;</code>来进行匹配。在提取引号里面的内容时，可以使用 <code>[^&quot;]+</code>，方括号里面的内容时，可以使用 <code>[^&gt;]+</code> 等方式。</p>
<p>我们通过一些常见的问题，逐步进行分析，讲解了正则表达式书写时的思路，和一些常见的错误。这些正则如果用于校验，还需要添加断言，比如 \A 和 \z（或\Z），或 <code>^</code> 和 <code>$</code>。如果用于数据提取，还应当在首尾添加相应的断言。</p>
<h2 id="总结">总结</h2>
<p>好了，今天的内容讲完了，我来带你总结回顾一下。</p>
<p>今天我们了解了下正则处理问题的基本思路，通常是将问题拆解成多个小问题，每个小问题见招拆招：某个位置上可能是多个单字符就⽤字符组，某个位置上可能是多个字符串就⽤多选结构，出现次数不确定就⽤量词，对出现的位置有要求就用断言。遇到问题，你遵循这些套路，写出正则其实并不难。</p>
<p>我们从一些日常的问题入手，详细地讲解了一些常见的案例，也讲解了可能会遇到的一些坑，比如在使用多选结构时要注意的问题，你在后续工作中要注意避开这些问题。</p>
<p>我在这里给你放了一张今天所讲内容的总结脑图。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/cb7369507668fa94996d7852761ded64.png" alt=""></p>
<h2 id="课后思考">课后思考</h2>
<p>最后，我们来做一个小练习吧。你可以根据今天我们学习 IPv4 的方法，来写一下 IPv6 的正则表达式么？说一下你的分析思路和最终的答案，建议自己动手测试一下写出的正则。</p>
<p>IPv6 示例<br>
ABCD:EF01:2345:6789:ABCD:EF01:2345:6789<br>
这种表示法中，每个 X 的前导 0 是可以省略的，例如：<br>
2001:0DB8:0000:0023:0008:0800:200C:417A<br>
上面的 IPv6 地址，可以表示成下面这样<br>
2001:DB8:0:23:8:800:200C:417A</p>
<p>备注：这里不考虑 0 位压缩表示</p>
<p>好，今天的课程就结束了，希望可以帮助到你，也希望你在下方的留言区和我参与讨论，并把文章分享给你的朋友或者同事，一起交流一下。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E8%AF%BE/">正则表达式入门课</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BA%92%E8%81%94%E7%BD%91%E4%BA%BA%E7%9A%84%E8%8B%B1%E8%AF%AD%E7%A7%81%E6%95%99%E8%AF%BE/12__%E8%B0%93%E8%AF%AD%E5%8A%A8%E8%AF%8D%E6%B0%B8%E8%BF%9C%E6%98%AF%E8%8B%B1%E8%AF%AD%E5%8F%A5%E5%AD%90%E7%9A%84%E6%A0%B8%E5%BF%83/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">12__谓语动词永远是英语句子的核心</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E9%AB%98%E6%89%8B%E8%AF%BE/12__%E6%88%91%E4%BB%AC%E8%A6%81%E5%85%88%E5%AE%9E%E7%8E%B0%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD%E8%BF%98%E6%98%AF%E5%85%88%E4%BC%98%E5%8C%96%E4%BB%A3%E7%A0%81/">
            <span class="next-text nav-default">12__我们要先实现业务功能，还是先优化代码？</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
