<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>18__知识点串讲：基于DDD的微服务设计实例 - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="你好，我是欧创新。
为了更好地理解 DDD 的设计流程，今天我会用一个项目来带你了解 DDD 的战略设计和战术设计，走一遍从领域建模到微服务设计的全过程，一起掌握 DDD 的主要设计流程和关键点。
" /><meta name="keywords" content="技术文档, docs, 极客时间" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/ddd%E5%AE%9E%E6%88%98%E8%AF%BE/18__%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%B2%E8%AE%B2%E5%9F%BA%E4%BA%8Eddd%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AE%BE%E8%AE%A1%E5%AE%9E%E4%BE%8B/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/ddd%E5%AE%9E%E6%88%98%E8%AF%BE/18__%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%B2%E8%AE%B2%E5%9F%BA%E4%BA%8Eddd%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%AE%BE%E8%AE%A1%E5%AE%9E%E4%BE%8B/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="18__知识点串讲：基于DDD的微服务设计实例">
  <meta property="og:description" content="你好，我是欧创新。
为了更好地理解 DDD 的设计流程，今天我会用一个项目来带你了解 DDD 的战略设计和战术设计，走一遍从领域建模到微服务设计的全过程，一起掌握 DDD 的主要设计流程和关键点。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="DDD实战课">

  <meta itemprop="name" content="18__知识点串讲：基于DDD的微服务设计实例">
  <meta itemprop="description" content="你好，我是欧创新。
为了更好地理解 DDD 的设计流程，今天我会用一个项目来带你了解 DDD 的战略设计和战术设计，走一遍从领域建模到微服务设计的全过程，一起掌握 DDD 的主要设计流程和关键点。">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="5150">
  <meta itemprop="keywords" content="DDD实战课">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="18__知识点串讲：基于DDD的微服务设计实例">
  <meta name="twitter:description" content="你好，我是欧创新。
为了更好地理解 DDD 的设计流程，今天我会用一个项目来带你了解 DDD 的战略设计和战术设计，走一遍从领域建模到微服务设计的全过程，一起掌握 DDD 的主要设计流程和关键点。">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">18__知识点串讲：基于DDD的微服务设计实例</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> 极客时间 </a>
            </div>
          <span class="more-meta"> 约 5150 字 </span>
          <span class="more-meta"> 预计阅读 11 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#项目基本信息">项目基本信息</a></li>
        <li><a href="#战略设计">战略设计</a>
          <ul>
            <li><a href="#1-产品愿景">1. 产品愿景</a></li>
            <li><a href="#2-场景分析">2. 场景分析</a></li>
            <li><a href="#3-领域建模">3. 领域建模</a></li>
            <li><a href="#4-微服务的拆分">4. 微服务的拆分</a></li>
          </ul>
        </li>
        <li><a href="#战术设计">战术设计</a>
          <ul>
            <li><a href="#1-分析微服务领域对象">1. 分析微服务领域对象</a></li>
            <li><a href="#2-设计微服务代码结构">2. 设计微服务代码结构</a></li>
          </ul>
        </li>
        <li><a href="#后续的工作">后续的工作</a>
          <ul>
            <li><a href="#1-详细设计">1. 详细设计</a></li>
            <li><a href="#2-代码开发和测试">2. 代码开发和测试</a></li>
          </ul>
        </li>
        <li><a href="#总结">总结</a></li>
        <li><a href="#思考题">思考题</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>你好，我是欧创新。</p>
<p>为了更好地理解 DDD 的设计流程，今天我会用一个项目来带你了解 DDD 的战略设计和战术设计，走一遍从领域建模到微服务设计的全过程，一起掌握 DDD 的主要设计流程和关键点。</p>
<h2 id="项目基本信息">项目基本信息</h2>
<p>项目的目标是实现在线请假和考勤管理。功能描述如下：</p>
<ol>
<li>请假人填写请假单提交审批，根据请假人身份、请假类型和请假天数进行校验，根据审批规则逐级递交上级审批，逐级核批通过则完成审批，否则审批不通过退回申请人。</li>
<li>根据考勤规则，核销请假数据后，对考勤数据进行校验，输出考勤统计。</li>
</ol>
<h2 id="战略设计">战略设计</h2>
<p>战略设计是根据用户旅程分析，找出领域对象和聚合根，对实体和值对象进行聚类组成聚合，划分限界上下文，建立领域模型的过程。</p>
<p>战略设计采用的方法是事件风暴，包括：产品愿景、场景分析、领域建模和微服务拆分等几个主要过程。</p>
<p>战略设计阶段建议参与人员：领域专家、业务需求方、产品经理、架构师、项目经理、开发经理和测试经理。</p>
<h3 id="1-产品愿景">1. 产品愿景</h3>
<p>产品愿景是对产品顶层价值设计，对产品目标用户、核心价值、差异化竞争点等信息达成一致，避免产品偏离方向。</p>
<p>事件风暴时，所有参与者针对每一个要点，在贴纸上写出自己的意见，贴到白板上。事件风暴主持者会对每个贴纸，讨论并对发散的意见进行收敛和统一，形成下面的产品愿景图。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/caec0d9262a1c0038a7799a49784dedc.png" alt=""></p>
<p>**我们把这个产品愿景图整理成一段文字就是：**为了满足内外部人员，他们的在线请假、自动考勤统计和外部人员管理的需求，我们建设这个在线请假考勤系统，它是一个在线请假平台，可以自动考勤统计。它可以同时支持内外网请假，同时管理内外部人员请假和定期考勤分析，而不像 HR 系统，只管理内部人员，且只能内网使用。我们的产品内外网皆可使用，可实现内外部人员无差异管理。</p>
<p>通过产品愿景分析，项目团队统一了系统名称——在线请假考勤系统，明确了项目目标和关键功能，与竞品（HR）的关键差异以及自己的优势和核心竞争力等。</p>
<p>产品愿景分析对于初创系统明确系统建设重点，统一团队建设目标和建立通用语言是很有价值的。但如果你的系统目标和需求非常清晰，这一步可以忽略。</p>
<h3 id="2-场景分析">2. 场景分析</h3>
<p>场景分析是从用户视角出发，探索业务领域中的典型场景，产出领域中需要支撑的场景分类、用例操作以及不同子域之间的依赖关系，用以支撑领域建模。</p>
<p>项目团队成员一起用事件风暴分析请假和考勤的用户旅程。根据不同角色的旅程和场景分析，尽可能全面地梳理从前端操作到后端业务逻辑发生的所有操作、命令、领域事件以及外部依赖关系等信息。</p>
<p><strong>下面我就以请假和人员两个场景作为示例。</strong></p>
<p>第一个场景：请假</p>
<p>用户：请假人</p>
<ol>
<li>请假人登录系统：从权限微服务获取请假人信息和权限数据，完成登录认证。</li>
<li>创建请假单：打开请假页面，选择请假类型和起始时间，录入请假信息。保存并创建请假单，提交请假审批。</li>
<li>修改请假单：查询请假单，打开请假页面，修改请假单，提交请假审批。</li>
<li>提交审批：获取审批规则，根据审批规则，从人员组织关系中获取审批人，给请假单分配审批人。</li>
</ol>
<p>第二个场景：审批</p>
<p>用户：审批人</p>
<ol>
<li>审批人登录系统：从权限微服务获取审批人信息和权限数据，完成登录认证。</li>
<li>获取请假单：获取审批人名下请假单，选择请假单。</li>
<li>审批：填写审批意见。</li>
<li>逐级审批：如果还需要上级审批，根据审批规则，从人员组织关系中获取审批人，给请假单分配审批人。重复以上 4 步。</li>
<li>最后审批人完成审批。</li>
</ol>
<p>完成审批后，产生请假审批已通过领域事件。后续有两个进一步的业务操作：发送请假审批已通过的通知，通知邮件系统告知请假人；将请假数据发送到考勤以便核销。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/8be84242c56f73b4cf119484c0ee8f57.png" alt=""></p>
<p>下面这个图是人员组织关系场景分析结果图，详细的分析过程以及考勤的场景分析就不描述了。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/7c4a17d6aff1ff445e10f75e1978f9ad.png" alt=""></p>
<h3 id="3-领域建模">3. 领域建模</h3>
<p>领域建模是通过对业务和问题域进行分析，建立领域模型。向上通过限界上下文指导微服务边界设计，向下通过聚合指导实体对象设计。</p>
<p>领域建模是一个收敛的过程，分三步：</p>
<ol>
<li>第一步找出领域实体和值对象等领域对象；</li>
<li>第二步找出聚合根，根据实体、值对象与聚合根的依赖关系，建立聚合；</li>
<li>第三步根据业务及语义边界等因素，定义限界上下文。</li>
</ol>
<p>下面我们就逐步详细讲解一下。</p>
<p><strong>第一步：找出实体和值对象等领域对象</strong></p>
<p>根据场景分析，分析并找出发起或产生这些命令或领域事件的实体和值对象。将与实体或值对象有关的命令和事件聚集到实体。</p>
<p>下面这个图是分析后的实体与命令的关系。通过分析，我们找到了：请假单、审批意见、审批规则、人员、组织关系、刷卡明细、考勤明细以及考勤统计等实体和值对象。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/d615a8fdffcbfd13629e00cd096877b8.png" alt=""></p>
<p><strong>第二步：定义聚合</strong></p>
<p>定义聚合前，先找出聚合根。从上面的实体中，我们可以找出“请假单”和“人员”两个聚合根。然后找出与聚合根紧密依赖的实体和值对象。我们发现审批意见、审批规则和请假单紧密关联，组织关系和人员紧密关联。</p>
<p>找出这些实体的关系后，我们发现还有刷卡明细、考勤明细和考勤统计，这几个实体没有聚合根。这种情形在领域建模时你会经常遇到，对于这类场景我们需要分情况特殊处理。</p>
<p>刷卡明细、考勤明细和考勤统计这几个实体，它们之间相互独立，找不出聚合根，不是富领域模型，但它们一起完成考勤业务逻辑，具有很高的业务内聚性。我们将这几个业务关联紧密的实体，放在一个考勤聚合内。在微服务设计时，我们依然采用 DDD 的设计和分析方法。由于没有聚合根来管理聚合内的实体，我们可以用传统的方法来管理实体。</p>
<p>经过分析，我们建立了请假、人员组织关系和考勤三个聚合。其中请假聚合有请假单、审批意见实体和审批规则等值对象。人员组织关系聚合有人员和组织关系等实体。考勤聚合有刷卡明细、考勤明细和考勤统计等实体。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/420d7365e5b8165dda4a80f111fffa0b.png" alt=""></p>
<p><strong>第三步：定义限界上下文</strong></p>
<p>由于人员组织关系聚合与请假聚合，共同完成请假的业务功能，两者在请假的限界上下文内。考勤聚合则单独构成考勤统计限界上下文。因此我们为业务划分请假和考勤统计两个限界上下文，建立请假和考勤两个领域模型。</p>
<h3 id="4-微服务的拆分">4. 微服务的拆分</h3>
<p>理论上一个限界上下文就可以设计为一个微服务，但还需要综合考虑多种外部因素，比如：职责单一性、敏态与稳态业务分离、非功能性需求（如弹性伸缩、版本发布频率和安全等要求）、软件包大小、团队沟通效率和技术异构等非业务要素。</p>
<p>在这个项目，我们划分微服务主要考虑职责单一性原则。因此根据限界上下文就可以拆分为请假和考勤两个微服务。其中请假微服务包含人员组织关系和请假两个聚合，考勤微服务包含考勤聚合。</p>
<p>到这里，战略设计就结束了。通过战略设计，我们建立了领域模型，划分了微服务边界。下一步就是战术设计了，也就是微服务设计。下面我们以请假微服务为例，讲解其设计过程。</p>
<h2 id="战术设计">战术设计</h2>
<p>战术设计是根据领域模型进行微服务设计的过程。这个阶段主要梳理微服务内的领域对象，梳理领域对象之间的关系，确定它们在代码模型和分层架构中的位置，建立领域模型与微服务模型的映射关系，以及服务之间的依赖关系。</p>
<p>战术设计阶段建议参与人员：领域专家、产品经理、架构师、项目经理、开发经理和测试经理等。</p>
<p>战术设计包括以下两个阶段：分析微服务领域对象和设计微服务代码结构。</p>
<h3 id="1-分析微服务领域对象">1. 分析微服务领域对象</h3>
<p>领域模型有很多领域对象，但是这些对象带有比较重的业务属性。要完成从领域模型到微服务的落地，还需要进一步的分析和设计。在事件风暴基础上，我们进一步细化领域对象以及它们的关系，补充事件风暴可能遗漏的业务和技术细节。</p>
<p>我们分析微服务内应该有哪些服务？服务的分层？应用服务由哪些服务组合和编排完成？领域服务包括哪些实体和实体方法？哪个实体是聚合根？实体有哪些属性和方法？哪些对象应该设计为值对象等。</p>
<p><strong>服务的识别和设计</strong></p>
<p>事件风暴的命令是外部的一些操作和业务行为，也是微服务对外提供的能力。它往往与微服务的应用服务或者领域服务对应。我们可以将命令作为服务识别和设计的起点。具体步骤如下：</p>
<ol>
<li>根据命令设计应用服务，确定应用服务的功能，服务集合，组合和编排方式。服务集合中的服务包括领域服务或其它微服务的应用服务。</li>
<li>根据应用服务功能要求设计领域服务，定义领域服务。这里需要注意：应用服务可能是由多个聚合的领域服务组合而成的。</li>
<li>根据领域服务的功能，确定领域服务内的实体以及功能。</li>
<li>设计实体基本属性和方法。</li>
</ol>
<p>另外，我们还要考虑领域事件的异步化处理。</p>
<p>我以提交审批这个动作为例，来说明服务的识别和设计。提交审批的大体流程是：</p>
<ol>
<li>根据请假类型和时长，查询请假审批规则，获取下一步审批人的角色。</li>
<li>根据审批角色从人员组织关系中查询下一审批人。</li>
<li>为请假单分配审批人，并将审批规则保存至请假单。</li>
<li>通过分析，我们需要在应用层和领域层设计以下服务和方法。</li>
</ol>
<p>**应用层：**提交审批应用服务。</p>
<p>**领域层：**领域服务有查询审批规则、修改请假流程信息服务以及根据审批规则查询审批人服务，分别位于请假和人员组织关系聚合。请假单实体有修改请假流程信息方法，审批规则值对象有查询审批规则方法。人员实体有根据审批规则查询审批人方法。下图是我们分析出来的服务以及它们之间的依赖关系。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/c120f902fb7e1623f2982b488444cf12.png" alt=""></p>
<p>服务的识别和设计过程就是这样了，我们再来设计一下聚合内的对象。</p>
<p><strong>聚合中的对象</strong></p>
<p>在请假单聚合中，聚合根是请假单。</p>
<p>请假单经多级审核后，会产生多条审批意见，为了方便查询，我们可以将审批意见设计为实体。请假审批通过后，会产生请假审批通过的领域事件，因此还会有请假事件实体。请假聚合有以下实体：审批意见（记录审批人、审批状态和审批意见）和请假事件实体。</p>
<p>我们再来分析一下请假单聚合的值对象。请假人和下一审批人数据来源于人员组织关系聚合中的人员实体，可设计为值对象。人员类型、请假类型和审批状态是枚举值类型，可设计为值对象。确定请假审批规则后，审批规则也可作为请假单的值对象。请假单聚合将包含以下值对象：请假人、人员类型、请假类型、下一审批人、审批状态和审批规则。</p>
<p>综上，我们就可以画出请假聚合对象关系图了。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/51913eed9374d832197964549b4dceb7.png" alt=""></p>
<p>在人员组织关系聚合中，我们可以建立人员之间的组织关系，通过组织关系类型找到上级审批领导。它的聚合根是人员。实体有组织关系（包括组织关系类型和上级审批领导）。其中组织关系类型（如项目经理、处长、总经理等）是值对象。上级审批领导来源于人员聚合根，可设计为值对象。人员组织关系聚合将包含以下值对象：组织关系类型、上级审批领导。</p>
<p>综上，我们又可以画出人员组织关系聚合对象关系图了。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/32fc4e6840127ed1fb6cadfef449f156.png" alt=""></p>
<p><strong>微服务内的对象清单</strong></p>
<p>在确定各领域对象的属性后，我们就可以设计各领域对象在代码模型中的代码对象（包括代码对象的包名、类名和方法名），建立领域对象与代码对象的一一映射关系了。根据这种映射关系，相关人员可快速定位到业务逻辑所在的代码位置。在经过以上分析后，我们在微服务内就可以分析出如下图的对象清单。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/d22c6f4d80ea55fb68038035ef2afd64.png" alt=""></p>
<h3 id="2-设计微服务代码结构">2. 设计微服务代码结构</h3>
<p>根据 DDD 的代码模型和各领域对象所在的包、类和方法，我们可以定义出请假微服务的代码结构，设计代码对象。</p>
<p><strong>应用层代码结构</strong></p>
<p>应用层包括：应用服务、DTO 以及事件发布相关代码。在 LeaveApplicationService 类内实现与聚合相关的应用服务，在 LoginApplicationService 封装外部微服务认证和权限的应用服务。</p>
<p>这里提醒一下：如果应用服务逻辑复杂的话，一个应用服务就可以构建一个类，这样可以避免一个类的代码过于庞大，不利于维护。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/e0a677f5a1d1660ddce1b3a1b5fd7280.png" alt=""></p>
<p><strong>领域层代码结构</strong></p>
<p>领域层包括一个或多个聚合的实体类、事件实体类、领域服务以及工厂、仓储相关代码。一个聚合对应一个聚合代码目录，聚合之间在代码上完全隔离，聚合之间通过应用层协调。</p>
<p>请假微服务领域层包含请假和人员两个聚合。人员和请假代码都放在各自的聚合所在目录结构的代码包中。如果随着业务发展，人员相关功能需要从请假微服务中拆分出来，我们只需将人员聚合代码包稍加改造，独立部署，即可快速发布为人员微服务。到这里，微服务内的领域对象，分层以及依赖关系就梳理清晰了。微服务的总体架构和代码模型也基本搭建完成了。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/42d9bcebd4cfb2ee0534d6f77f4cb6c7.png" alt=""></p>
<h2 id="后续的工作">后续的工作</h2>
<h3 id="1-详细设计">1. 详细设计</h3>
<p>在完成领域模型和微服务设计后，我们还需要对微服务进行详细的设计。主要设计以下内容：实体属性、数据库表和字段、实体与数据库表映射、服务参数规约及功能实现等。</p>
<h3 id="2-代码开发和测试">2. 代码开发和测试</h3>
<p>开发人员只需要按照详细的设计文档和功能要求，找到业务功能对应的代码位置，完成代码开发就可以了。代码开发完成后，开发人员要编写单元测试用例，基于挡板模拟依赖对象完成服务测试。</p>
<h2 id="总结">总结</h2>
<p>今天我们通过在线请假考勤项目，把 DDD 设计过程完整地走了一遍。</p>
<p>DDD 战略设计从事件风暴开始，然后我们要找出实体等领域对象，找出聚合根构建聚合，划分限界上下文，建立领域模型。</p>
<p>战术设计从事件风暴的命令开始，识别和设计服务，建立各层服务的依赖关系，设计微服务内的实体和值对象，找出微服务中所有的领域对象，并建立领域对象与代码对象的映射关系。</p>
<p>这样就可以很好地指导项目团队进行微服务开发和测试了。总结完毕，到这你是否已经清楚 DDD 全部的设计过程了呢？有疑问欢迎留言讨论。</p>
<h2 id="思考题">思考题</h2>
<p>你现在采用的是什么样的微服务设计方法？你认为有什么需要特别注意的事项呢？目前有何难点痛点？分享出来，也许我能给你一些有效的建议。</p>
<p>最后，如果今天的实战项目，可以让你举一反三、有所收获，欢迎分享给你的朋友，邀请他加入学习。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/DDD%E5%AE%9E%E6%88%98%E8%AF%BE/e4872e412bb3131e6dec8a85bb125c27.png" alt=""></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/ddd%E5%AE%9E%E6%88%98%E8%AF%BE/">DDD实战课</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E5%88%86%E5%B8%83%E5%BC%8F%E9%87%91%E8%9E%8D%E6%9E%B6%E6%9E%84/18__%E6%AD%A3%E7%A1%AE%E6%80%A7%E6%A1%88%E4%BE%8B%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%96%B9%E6%A1%88%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">18__正确性案例（中）：常见分布式数据方案的设计原理是什么？</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E8%81%8C%E5%9C%BA%E6%B1%82%E7%94%9F%E6%94%BB%E7%95%A5/18__%E8%81%8C%E5%9C%BA%E6%94%BF%E6%B2%BB%E6%88%91%E5%8F%AA%E6%83%B3%E5%A5%BD%E5%A5%BD%E5%B9%B2%E6%B4%BB%E8%81%8C%E5%9C%BA%E6%94%BF%E6%B2%BB%E5%92%8C%E6%88%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB/">
            <span class="next-text nav-default">18__职场政治：我只想好好干活，职场政治和我有什么关系？</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
