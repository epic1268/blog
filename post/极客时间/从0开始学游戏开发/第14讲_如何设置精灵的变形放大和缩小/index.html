<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>第14讲_如何设置精灵的变形、放大和缩小？ - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="上周四，我给你讲解了图片的遮挡问题。这一节我要和你讲精灵的变形、放大和缩小。如果之前没有做过游戏开发，你肯定会问，什么是精灵？
什么是精灵？ 我先来解释一下什么是精灵。精灵当然不是我们传统意义上的什么树林里的精灵。精灵是一个游戏开发中的名词，英文叫 Sprite。
" /><meta name="keywords" content="技术文档, docs, 极客时间" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/%E7%AC%AC14%E8%AE%B2_%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E7%B2%BE%E7%81%B5%E7%9A%84%E5%8F%98%E5%BD%A2%E6%94%BE%E5%A4%A7%E5%92%8C%E7%BC%A9%E5%B0%8F/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/%E7%AC%AC14%E8%AE%B2_%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E7%B2%BE%E7%81%B5%E7%9A%84%E5%8F%98%E5%BD%A2%E6%94%BE%E5%A4%A7%E5%92%8C%E7%BC%A9%E5%B0%8F/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="第14讲_如何设置精灵的变形、放大和缩小？">
  <meta property="og:description" content="上周四，我给你讲解了图片的遮挡问题。这一节我要和你讲精灵的变形、放大和缩小。如果之前没有做过游戏开发，你肯定会问，什么是精灵？
什么是精灵？ 我先来解释一下什么是精灵。精灵当然不是我们传统意义上的什么树林里的精灵。精灵是一个游戏开发中的名词，英文叫 Sprite。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="从0开始学游戏开发">

  <meta itemprop="name" content="第14讲_如何设置精灵的变形、放大和缩小？">
  <meta itemprop="description" content="上周四，我给你讲解了图片的遮挡问题。这一节我要和你讲精灵的变形、放大和缩小。如果之前没有做过游戏开发，你肯定会问，什么是精灵？
什么是精灵？ 我先来解释一下什么是精灵。精灵当然不是我们传统意义上的什么树林里的精灵。精灵是一个游戏开发中的名词，英文叫 Sprite。">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="3120">
  <meta itemprop="keywords" content="从0开始学游戏开发">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="第14讲_如何设置精灵的变形、放大和缩小？">
  <meta name="twitter:description" content="上周四，我给你讲解了图片的遮挡问题。这一节我要和你讲精灵的变形、放大和缩小。如果之前没有做过游戏开发，你肯定会问，什么是精灵？
什么是精灵？ 我先来解释一下什么是精灵。精灵当然不是我们传统意义上的什么树林里的精灵。精灵是一个游戏开发中的名词，英文叫 Sprite。">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">第14讲_如何设置精灵的变形、放大和缩小？</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> 极客时间 </a>
            </div>
          <span class="more-meta"> 约 3120 字 </span>
          <span class="more-meta"> 预计阅读 7 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#什么是精灵">什么是精灵？</a></li>
        <li><a href="#设置变形放大和缩小需要用到哪些函数">设置变形、放大和缩小需要用到哪些函数？</a>
          <ul>
            <li><a href="#翻转函数-flip">翻转函数 flip</a></li>
            <li><a href="#缩放函数-scale">缩放函数 scale</a></li>
            <li><a href="#旋转函数-rotate">旋转函数 rotate</a></li>
            <li><a href="#剪切函数-chop">剪切函数 chop</a></li>
          </ul>
        </li>
        <li><a href="#pygame-中的-sprite">Pygame 中的 Sprite</a>
          <ul>
            <li><a href="#类-explode">类 explode</a></li>
            <li><a href="#重载函数-update">重载函数 update</a></li>
          </ul>
        </li>
        <li><a href="#小结">小结</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>上周四，我给你讲解了图片的遮挡问题。这一节我要和你讲精灵的变形、放大和缩小。如果之前没有做过游戏开发，你肯定会问，什么是精灵？</p>
<h2 id="什么是精灵">什么是精灵？</h2>
<p>我先来解释一下什么是精灵。精灵当然不是我们传统意义上的什么树林里的精灵。精灵是一个游戏开发中的名词，英文叫 Sprite。</p>
<blockquote>
<p>它多用于游戏中的人物和可移动物品，也可以用于显示鼠标指针和输入的文字。如果屏幕上的可移动物体的尺寸比一个精灵图要大，可由若干个精灵图缩放或者拼接而成。</p>
</blockquote>
<p>从<strong>宏观</strong>的概念讲，精灵就是一幅图片。比如我们之前中讲过的那些飞机图、背景图，这些都可以认为是精灵或者是从精灵中派生出来的。它就是一系列可以变化的图片。这些图片可以变形、放大、缩小，或者是一系列的动画帧等等。</p>
<p>从<strong>编程</strong>的角度讲，精灵是一种管理器。在一个精灵的管理器中，可能会有一系列的方法去操作精灵，比如添有加、删除操作，比如有图像的变形、放大、缩小操作，还有系列帧的显示操作等。</p>
<p>既然，精灵就是图片，那在“打飞机”中，飞机会随着画面的变化、操作的不同，而有变形、放大以及缩小的状态。我现在就来讲这些操作的实现，需要用到哪些函数，以及这背后都有什么技巧。</p>
<h2 id="设置变形放大和缩小需要用到哪些函数">设置变形、放大和缩小需要用到哪些函数？</h2>
<p>Pygame 中的底层，使用的是 SDL 开发库，这个我们在之前的内容中已经讲过，因此，这些变形、放大缩小等操作，都有对应的 SDL 库。</p>
<p>我们要用到的还是之前的飞机图片，为了让你更明确的看清楚，我删除了背景，只呈现飞机的内容。</p>
<h3 id="翻转函数-flip">翻转函数 flip</h3>
<p>我们首先要用到的是<strong>函数 flip</strong>。顾名思义，这个函数就是让你对图片进行翻转，你可以翻转成水平的或者垂直的。所以它拥有两个参数，一个是传入 x，一个是传入 y，并且都需要传入<strong>布尔值</strong>。如果传入 x 值为真，那就进行水平镜像翻转，如果 y 值为真，那就进行垂直镜像翻转，两个都为真，两方都进行翻转。这个函数会返回一个 surface。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.flip(pln, 1, 1)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">screen.blit(pln_t, (40, 350))
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们看到的结果是这样：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/ef525a753a64b0af19314d9aaa5898d2.png" alt=""></p>
<p>原本飞机的头是朝上的，现在进行了水平和垂直的翻转。</p>
<h3 id="缩放函数-scale">缩放函数 scale</h3>
<p>我们再来看一下<strong>缩放的函数 scale</strong>。scale 的参数是这样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">scale(Surface, (width, height), DestSurface =None)
</span></span></code></pre></td></tr></table>
</div>
</div><p>其中第一个参数是绘制对象，第二个参数是缩放大小，第三个参数一般不太使用，指的是目标对象。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.scale(pln, (220,220))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">screen.blit(pln_t, (20, 150))
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们在代码中，将 pln 这个对象放大到 220×220（飞机原本大小为 195×62），然后看一下效果。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/486620a57b2a5fbc7a696c624e1f73ea.png" alt=""></p>
<p>你看，飞机变大了。我们再尝试修改一下代码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.scale(pln, (20,20))
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/a96a7fec3326eff0689b31cd04bdf919.png" alt=""></p>
<p>飞机就变小了。所以，<strong>scale 函数</strong>的作用是，<strong>只要你传入参数的 width 和 height 值大于原本精灵的长宽值，就变大，否则就变小。</strong></p>
<p>类似，我们还有一个<strong>函数 scale2x</strong>，你只需要填入绘制对象即可，函数会帮你进行两倍扩大，不需要你计算原本的长宽值并且乘以 2。</p>
<h3 id="旋转函数-rotate">旋转函数 rotate</h3>
<p>我们再来看一下<strong>rotate 旋转函数</strong>。它提供一个参数 angle，也就是你需要旋转的角度，正负值都可以。</p>
<p>我们来看一下代码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.rotate(pln, 20)
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们看到的效果就像这样。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/08e08f7191ff06f35cf45c832d569694.png" alt=""></p>
<p>这样飞机就朝左侧旋转了 20 度。相似的，也有整合的函数<strong>rotozoom</strong>。它该函数提供了旋转和扩大的功能。</p>
<p>如果代码这么写：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.rotozoom(pln, 20, 2)
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们能看到的效果就是这样：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/616207dabf7a67c8ee62cf65828b063a.png" alt=""></p>
<h3 id="剪切函数-chop">剪切函数 chop</h3>
<p>接下来的是<strong>函数 chop</strong>，这个函数提供了图像剪切的功能。我们需要传入一个绘制对象以及一个 rect 矩形，这样就可以将输入的矩形的内容剪切出来。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pln_t = pygame.transform.chop(pln, [20,150,25,155])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    screen.blit(pln_t, (20, 150))
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们看一下代码的内容，我们在 blit 的时候，将 pln_t 放置在 (20,150) 的位置上，所以我们在 chop 的时候，将剪裁 [20,150,25,155] 这样一个矩形进行裁切。</p>
<p>然后我们来看一下效果。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/c9f0069358479b44f043ca65cda92e4b.png" alt=""><br>
这么多函数，是不是容易记不住？我来给这一部分做个总结：</p>
<p><strong>对于精灵的所有放大、缩小或者变换的函数，都在 pygame.transform 模块里。它提供了一系列 2D 精灵的变换操作，包括旋转角度、缩小放大、镜像、描边、切割等功能，让你很方便地能够在游戏中随心所欲地对处理 2D 精灵。</strong></p>
<h2 id="pygame-中的-sprite">Pygame 中的 Sprite</h2>
<p>我们再来看一下 Pygame 本身，Pygame 本身就提供有 Sprite 模块，Sprite 模块提供了 Sprite 类，事实上，Pygame 的精灵类最方便的功能就是将某些序列帧的图片，做成动画，并且保存在 Sprite 的组（group）里面。在 Pygame 里面，Sprite 是一个轻量级的模块，我们需要做的是要将这个模块继承下来，并且重载某些方法。</p>
<h3 id="类-explode">类 explode</h3>
<p>我们现在有一副图片，效果是打击到某个点，开始爆开图案。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/7551a3bc646691bb1da97c859083c172.png" alt=""></p>
<p>这幅图片一共三帧，是一个标准的精灵动画。那么我们需要做的，就是先将这幅图片导入到精灵类当中。我们做一个类 explode：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class explode(pygame.sprite.Sprite):
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个类继承自 Sprite 类，然后我们定义一个初始化函数，并且首先调用上层基类的初始化。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  def __init__(self, target, frame, single_w, single_h, pos=(0,0)):
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        pygame.sprite.Sprite.__init__(self)
</span></span></code></pre></td></tr></table>
</div>
</div><p>在这个类当中，我们看到了函数的定义内容，第一个参数<strong>self</strong>，我就不过多解释了；<strong>target</strong>是我们需要载入的目标图片；<strong>frame</strong>是我们需要告诉这个类，我们这个动画有几帧；<strong>single_w, single_h</strong> 代表了我们每一帧动画的长宽。在这里，我们的每一格动画是 262×262。<strong>pos</strong>是我们告诉屏幕，将这个动画放置在屏幕的什么位置。</p>
<p>接下来，这是我编写的初始化代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">single_w</span><span class="p">,</span> <span class="n">single_h</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="n">pygame</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">convert_alpha</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">main_image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">get_rect</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">single_w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_h</span> <span class="o">=</span> <span class="n">single_w</span><span class="p">,</span> <span class="n">single_h</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="bp">self</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">topleft</span> <span class="o">=</span> <span class="n">pos</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>大部分代码你应该都能理解，但是有几个点，我要特殊说明一下。</p>
<p>第一个是<strong>main_image</strong>。这个是保存主 image 图片。我们在后续的切换帧的时候，需要在 main_image 中切割后面几帧，并且呈现在屏幕上，这样就会在视觉效果中呈现动画效果。<strong>count</strong>是每一帧的当前计数。在这里我们一共拥有三帧，这三帧我们记录在 self.frame 里，是总的帧数。</p>
<h3 id="重载函数-update">重载函数 update</h3>
<p>接下来，我们来看一下 update 代码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> def update(self):
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         if self.count &lt; self.frame-1:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">             self.count += 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         else:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">             self.count = 0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         self.image = self.main_image.subsurface([self.count*self.single_w, 0, self.single_w,self.single_h])
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Update</strong>是一个重载函数。事实上，在 update 函数里，需要判断帧数、当前循环的计数等等。但是，为了能让你能更直观容易地感受代码做了什么内容，所以我直接使用 self.count 来做帧数的计数。</p>
<p>进入函数后，我们使用 self.count 来和 self.frame 的总帧数进行对比。如果帧数不足以切换，那就加 1，否则就置为 0。判断结束后，我们就将 image 变成下一帧的内容。</p>
<p>其中，subsurface 的意思是传入一个 rect 值，并且将这个值的 surface 对象复制给 image 对象，并且呈现出来。</p>
<p>这时候，我们需要将这些内容放入到 group 中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">exp = explode(&#39;explode.png&#39;, 3, 262,262, (100,100))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">group = pygame.sprite.Group()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">group.add(exp)
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先，exp 就是我们定义的 explode 类的对象，我们分别传入的内容是图片、帧数、单个帧的宽度、单个帧的高度，并且将这个精灵显示在屏幕的位置。</p>
<p>随后，我们定义一个叫作 group 的对象，并且将 exp 对象填入 group 中。随后，我们在大循环内，写一串代码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">group.update()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    group.draw(screen)
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个 update，调用的就是<strong>exp.update 函数</strong>。draw 就是在 screen 中绘制我们填入 group 中的内容。由于动画在文章中无法显示，所以我就不将图片放入到文章中来了。</p>
<p>在精灵类中，我们除了动画的呈现，还有碰撞效果的制作。这属于更为复杂的层面，后续的内容，我将会用简单的方式来呈现碰撞的实现。</p>
<p>当然，Sprite 类还有更为高阶的用法，除了碰撞，还有 Layer（层）的概念。group 的添加精灵，事实上是没有次序概念的，所以哪个精灵在前，哪个在后是不清楚的，到了这个时候，你可以使用 OrderUpdates、LayerUpdates 这些类，其中 LayerUpdates 拥有众多方法可以调用，这样就会有分层的概念。</p>
<h2 id="小结">小结</h2>
<p>这一节，你需要记住这几个重点。</p>
<ul>
<li>精灵的变形、缩放以及 pygame 中关于精灵类的一些简单的操作。</li>
<li>你可以直观地感受到，精灵类和 group 类配合起来使用是一件很方便的事情，也就是说，我们忽略了 blit 的这些方法，直接在 group 中，进行 update 和 draw 就可以一次性做完很多的工作。</li>
<li>如果我们单独编写精灵的序列帧动画函数，也不是不行，但是你可能需要编写相当多的代码来代替 Sprite 和 group 类的工作。</li>
</ul>
<p>现在留一个小问题给你。</p>
<p>结合精灵的变形、放大和缩小，再结合 Pygame 精灵类的内容，要在 update 重载函数里绘制动画帧效果，并且不停地放大、缩小，该怎么实现呢？</p>
<p>欢迎留言说出你的看法。我在下一节的挑战中等你！</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/687aa95b3803eb0079b384dbad39d165.png" alt=""></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/">从0开始学游戏开发</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/java%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E9%9D%A2%E8%AF%95%E7%B2%BE%E8%AE%B2/%E7%AC%AC14%E8%AE%B2__%E8%B0%88%E8%B0%88%E4%BD%A0%E7%9F%A5%E9%81%93%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">第14讲__谈谈你知道的设计模式？</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E5%89%8D%E7%AB%AF%E9%AB%98%E6%89%8B%E8%BF%9B%E9%98%B6/%E7%AC%AC14%E8%AE%B2http%E5%8D%8F%E8%AE%AE%E5%92%8C%E5%AE%83%E7%9A%84%E8%A1%A5%E4%B8%81%E4%BB%AC/">
            <span class="next-text nav-default">第14讲：HTTP协议和它的“补丁”们</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
