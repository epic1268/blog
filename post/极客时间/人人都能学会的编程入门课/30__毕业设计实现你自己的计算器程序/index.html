<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>30__毕业设计：实现你自己的计算器程序 - Docs</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="" /><meta name="description" content="你好，我是胡光，欢迎来到“综合项目篇”的最后一节课。
这节课，我将带你完成一个富有挑战性的任务，就是一起开发一门“编程语言”。哈哈……我说开发一门编程语言当然是和你开玩笑，不过我们可以开发编程语言中的一小部分，那就是定义变量和基本的表达式运算功能。
" /><meta name="keywords" content="技术文档, docs, 极客时间" />






<meta name="generator" content="Hugo 0.140.2 with theme even" />


<link rel="canonical" href="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/30__%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0%E4%BD%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A8%E7%A8%8B%E5%BA%8F/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:url" content="https://politcloud.org/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/30__%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E5%AE%9E%E7%8E%B0%E4%BD%A0%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AE%A1%E7%AE%97%E5%99%A8%E7%A8%8B%E5%BA%8F/">
  <meta property="og:site_name" content="Docs">
  <meta property="og:title" content="30__毕业设计：实现你自己的计算器程序">
  <meta property="og:description" content="你好，我是胡光，欢迎来到“综合项目篇”的最后一节课。
这节课，我将带你完成一个富有挑战性的任务，就是一起开发一门“编程语言”。哈哈……我说开发一门编程语言当然是和你开玩笑，不过我们可以开发编程语言中的一小部分，那就是定义变量和基本的表达式运算功能。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-10T00:00:00+00:00">
    <meta property="article:tag" content="人人都能学会的编程入门课">

  <meta itemprop="name" content="30__毕业设计：实现你自己的计算器程序">
  <meta itemprop="description" content="你好，我是胡光，欢迎来到“综合项目篇”的最后一节课。
这节课，我将带你完成一个富有挑战性的任务，就是一起开发一门“编程语言”。哈哈……我说开发一门编程语言当然是和你开玩笑，不过我们可以开发编程语言中的一小部分，那就是定义变量和基本的表达式运算功能。">
  <meta itemprop="datePublished" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-10T00:00:00+00:00">
  <meta itemprop="wordCount" content="4539">
  <meta itemprop="keywords" content="人人都能学会的编程入门课">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="30__毕业设计：实现你自己的计算器程序">
  <meta name="twitter:description" content="你好，我是胡光，欢迎来到“综合项目篇”的最后一节课。
这节课，我将带你完成一个富有挑战性的任务，就是一起开发一门“编程语言”。哈哈……我说开发一门编程语言当然是和你开玩笑，不过我们可以开发编程语言中的一小部分，那就是定义变量和基本的表达式运算功能。">

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Docs</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Docs</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">30__毕业设计：实现你自己的计算器程序</h1>

      <div class="post-meta">
        <span class="post-time"> 10100-01-10 </span>
        <div class="post-category">
            <a href="/categories/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/"> 极客时间 </a>
            </div>
          <span class="more-meta"> 约 4539 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#计算器程序的功能设计">计算器程序的功能设计</a></li>
        <li><a href="#二叉树的遍历">二叉树的遍历</a></li>
        <li><a href="#思维利器表达式树">思维利器：表达式树</a></li>
        <li><a href="#确定运算符顺序的技巧">确定运算符顺序的技巧</a></li>
        <li><a href="#课程小结">课程小结</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>你好，我是胡光，欢迎来到“综合项目篇”的最后一节课。</p>
<p>这节课，我将带你完成一个富有挑战性的任务，就是一起开发一门“编程语言”。哈哈……我说开发一门编程语言当然是和你开玩笑，不过我们可以开发编程语言中的一小部分，那就是定义变量和基本的表达式运算功能。</p>
<p>三个月的时间，我们一起用 C 语言写了这么久的代码，我相信只要你坚持学习，不断拓展自己的编程能力，终有一天你可以开发出一门自己的编程语言。今天，我就带你打个头阵，从计算器程序开始。</p>
<h2 id="计算器程序的功能设计">计算器程序的功能设计</h2>
<p>我们将要实现的计算器程序也算是开发一个小项目，那么开发项目的第一步，就是对我们实现的功能进行设计，一般计算器功能如下：</p>
<ol>
<li>第一次出现的变量赋值语句，即为变量定义；</li>
<li>计算表达式的值。</li>
</ol>
<p>这两个功能，看似简单，可实际要考虑的还很多，例如：变量是否有作用域的限制啊，合法变量名的规则，表达式中支持的运算符种类啊，每一种运算符的优先级，等等。这些需要考虑的细节，每一个都会给我们的项目增加一点点难度。</p>
<p>为了把难度控制在一个可以实现的范围，我们对计算器功能做进一步的细致描述，同时也是降低项目实现难度，重新修订的功能定义如下：</p>
<ol>
<li>第一次出现的变量赋值语句，即为变量定义；</li>
<li>计算表达式的值；</li>
<li>没有作用域的概念，所有变量都是全局变量；</li>
<li>变量名只允许 26 个小写的英文字母，也就是说，程序中最多有 26 个变量；</li>
<li>表达式只支持四则混合运算 +、-、*、/ 以及 ()；</li>
<li>表达式中参与运算的值均为正整数，除法规则参考 C 语言整形之间的除法规则；</li>
<li>变量赋值语句和表达式语句，均各占一行。</li>
</ol>
<p>这里，我给你看一份符合上述规则的输入数据：</p>
<p>a = 3<br>
b = a * 3 + 5<br>
(a + 4) * (b + 5)</p>
<p>可以看到，第 1 行输入，定义了变量 a，同时给 a 变量赋值为 3；第 2 行，定义了变量 b，同时给 b 变量赋值为 a * 3 + 5 的值，也就是 14；第 3 行，是一行表达式，计算的是 (a + 4) * (b + 5) 的值，最后的结果应该等于 7 * 19 = 133。</p>
<p>针对这份输入数据，我们的计算器程序分别输出每行表达式对应的值，也就是：</p>
<p>3<br>
14<br>
133</p>
<p>清楚了计算器程序的功能以后，下面我就给你讲讲如何完成这个程序。</p>
<h2 id="二叉树的遍历">二叉树的遍历</h2>
<p>首先，你需要掌握二叉树的三种遍历方式，这是我们后续解决表达式求值问题的思维利器。在讲遍历方式之前，先来简单的看一下二叉树的基本结构。</p>
<p><strong>二叉树，就是每个节点下面最多有两个子节点的结构</strong>。如下图所示，就是一个二叉树结构：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/95c17319188bf772e2e55e078fc2a4f2.png" alt=""></p>
<p>图 1：二叉树结构示意图</p>
<p>我们把其中的 A 节点叫做“根节点”，B 和 C 是 A 节点的两个“子节点”，同理，E 和 F 是 C 节点的两个子节点，D 是 B 节点的子节点。如果更细致地划分，以 B 为根节点的子树，处于 A 节点的左侧，所以称为 A 节点的左子树，C 称为 A 节点的右子树。反过来，我们把 A 节点称为 B 和 C 节点的父节点，同时它也是 D、E、F 节点的祖先节点。以上就是二叉树中的一些基本概念了。</p>
<p>认识了二叉树的基本概念以后，我们接下来就来看看二叉树的三种遍历方式：前序遍历、中序遍历与后序遍历。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/82e7bbacce95984b2570e7119feb172e.png" alt=""></p>
<p>图 2：二叉树的遍历方式</p>
<p>从图中可见，每一种遍历的方式，都是采用递归的定义方式。而所谓的前、中、后序遍历，其实说的是根节点的位置：根节点在左右子树遍历之前，那就是前序遍历；夹在左右子树中间，就是中序遍历；位于左右子树遍历之后，那就是后序遍历。</p>
<p>如果我们将图 1 中的二叉树结构，分别按照三种方式进行遍历，会得到如下所示的遍历结果：</p>
<p>前序遍历：A B D C E F<br>
中序遍历：D B A E C F<br>
后序遍历：D B E F C A</p>
<p>这里你一定要注意，<strong>在写某一种遍历结果的时候，一定是按照递归展开的方式</strong>。例如，在中序遍历中，我们是将根节点左子树所形成的中序遍历结果（D B），放在根节点 A 的左侧，然后是根节点 A，接着是根节点右子树的中序遍历结果（E C F）。所以最后，整棵树的中序遍历结果就是 D B A E C F。</p>
<h2 id="思维利器表达式树">思维利器：表达式树</h2>
<p>介绍完了二叉树的基本概念及三种遍历方式后，我们接下来就要赋予这个二叉树结构一些实际的意义，让它能够帮助我们理解表达式求值的过程。</p>
<p>其实，<strong>任何一个四则混合运算的表达式，都能转换成相对应的二叉树，而原表达式的值，等于对应二叉树的后序遍历结果</strong>。例如，下图就是一个加法表达式和它所对应的表达式树：</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/af6b637aa684acdea990af8bbf35b74f.png" alt=""></p>
<p>图 3：表达式树示意图（一）</p>
<p>我们看到，在表达式树中，根节点就是运算符 +(加号)，加号的左子树是数字 3，右子树是数字 5。根据刚刚所说的对应规则，在表达式树上，按照后序遍历的顺序，得到的就是表达式的值。图 3 中的表达式树，首先遍历得到左子树的数字 3，再遍历得到右子树的数字 5，最后遍历到根节点的运算符 +(加号)，就将左右子树的值做加法，得到原表达式的结果 8。</p>
<p>下面，我们来看一个稍微复杂一点儿的表达式，以及它所对应的表达式树。</p>
<p><img src="https://raw.githubusercontent.com/epic1268/images/master/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/7eb197c172f52851f34e449226aa6a54.png" alt=""></p>
<p>图 4：表达式树示意图（二）</p>
<p>从图中可见，原表达式是 (3 + 5) * (6 - 2)，而其对应的表达式树中，已经没有了括号的影子。那括号的影响在表达式树上怎么体现呢？其实括号对表达式的影响，已经被表达式树转换成了等价的树形结构关系。这一点怎么理解呢，听我慢慢给你解释。</p>
<p>这里有个关键词，就是“顺序”。我们知道，表达式是按照计算顺序，得到计算结果的。表达式树，按照的是后序遍历方式，这本身也是规定了一种计算“顺序”。根据后序遍历规则，我们可以知道，表达式树的根节点所代表的运算，是原表达式中最后一个执行的运算。</p>
<p>我们回到示意图中具体示例来分析，图中表达式树的计算顺序应该是这样的：首先计算左子树所代表的 3 + 5 表达式的值，再计算右子树代表的 6 - 2 表达式的值，最后根据根节点的乘法运算，计算得到左右子树的乘积值。</p>
<p>如此你会发现，表达式树的这种计算顺序，与原表达式添加了括号以后的计算顺序等价。</p>
<p>综上所述，我们可知，表达式树中越靠近根节点的运算符，优先级越低，而根节点代表了原表达式中，优先级最低的那个运算符。表达式中原有的括号，其实就是用来控制运算符之间的计算顺序的，这种计算顺序，对应的就是表达式树中的父子节点关系，这就是我们刚刚所说的，<strong>原表达式中的括号，被转换成了等价的树形结构关系的含义</strong>。</p>
<p>理解了表达式树以后，对于我们计算表达式的值，究竟有何作用呢？难道是在程序中，将读入的表达式字符串，转换成程序内的一棵表达式树结构么？</p>
<p>不知道你还记不记得，之前我们在讲链表结构的时候，提到链表不仅仅是一种程序中的结构，更重要的是它所体现出来的“链表思维”。其实今天我们学习的表达式树结构同样如此，我们不需要在程序中真正地建立一棵表达式树，而是利用表达式树去理解表达式计算的过程。</p>
<p>下面我们就来具体看看，如何利用这种思维，解决表达式计算问题。</p>
<p>我们知道，任何一个表达式，都对应一个等价的表达式树。而这个表达式树的根节点所对应的，就是原表达式中最后一个被计算的运算符。如果我们可以找到这个运算符在原表达式中的位置，那么这个运算符所的左边部分，对应的就是表达式树根节点的左子树，运算符的右边部分，对应的就是表达式树根节点的右子树。</p>
<p>我们用 String 代表原表达式字符串，op 代表整个表达式中最后一个被计算的运算符，L_String 是 op 运算符左边的字符串，R_String 就是右边的字符串。</p>
<p>假设，我们有一个函数 get_val(String)，可以得到 String 所代表的表达式的值。那么关于 get_val(String)，我们就可以得到如下递推关系：</p>
<p>get_val(String) = get_val(L_String) op get_val(R_String)</p>
<p>也就是当前表达式的值，等于左边表达式的值与右边表达式的值之间的运算结果。</p>
<p>这里我给你举个具体的例子，还是拿前面的那个乘法表达式来看：</p>
<p>get_val(&quot;(3+5)*(6-2)&quot;) = get_val(&quot;(3+5)&quot;) * get_val(&quot;(6-2)&quot;)</p>
<p>如果我们能确定，表达式字符串中最后一个被计算的运算符的位置，我们就可以把原表达式字符串分成两部分，进行递归求解。所以，<strong>找到最后一个被计算的运算符的位置，才是我们完成程序的关键</strong>。</p>
<p>到了这里，关于如何利用表达式树来解决表达式计算问题，我们就解释完了。</p>
<p>最后，我们就来看一下，确定运算符计算顺序的处理技巧。</p>
<h2 id="确定运算符顺序的技巧">确定运算符顺序的技巧</h2>
<p>怎么确定表达式中每一个运算符的计算顺序呢？其实我们可以通过给每个运算符赋予一个权重，权重越高，代表计算优先级越高。下面我就来说说这个权重是怎么设置。</p>
<p>根据四则混合运算的基础规则，我们可以给 +、-、<code>*</code>、/ 运算符设定一个基础权重，例如，+、- 权重是 1，<code>*</code>、/ 权重是 2。</p>
<p>那括号呢？我们可以对括号里面的所有运算符，额外加上一个很大的权重。假设，运算符外有 1 层括号，就额外增加权重 100。如果一个运算符被套在了两层括号里面，那它的权重就应该被额外加上 200。</p>
<p>按照这个规则，请你计算下面这个表达式中，每个运算符的权重：</p>
<p>((3 + 5) * 6) - 7 * 9 + 4</p>
<p>很简单，从左到右，运算符号依次是 +、<code>*</code>、-、<code>*</code>、+，它们的运算符权重分别是 201、102、1、2、1。根据权重可知，最后一个被计算的运算符，应该是末尾权重为 1 的运算符，也就对应了表达式中最后一个 +(加号)。根据这个加号所在位置，我们可以把表达式分成左右两部分，进行递归求解。</p>
<p>在实际编码过程中，我们可以记录一个值 temp，代表由括号产生的额外权重，当碰到左括号的时候，我们就给 temp 加上 100，碰到右括号的时候，temp 就相应的减去 100。对于计算正常的 +、-、*、/ 运算符权重的时候，其权重值应该等于基础权重加上 temp 这个额外权重。</p>
<p>好了，整个程序的核心思路，我已经提供给你了，希望你能通过自己的思考，试着做出来。当然，如果你实在想不出来，可以参考文末我给出的参考代码。</p>
<p>至于如何定义变量，你可以先实现一个没有变量的表达式求值的程序，然后再将定义变量，作为一个新功能，加入到你的程序中。还记得我们之前讲的系统功能迭代过程吧？我们说：功能迭代，数据先行。对于定义变量这个功能的迭代，我们的实现过程也不例外，先思考清楚变量的值“如何存储，如何使用”，把这两个问题想明白了，功能也就开发完一半儿了。</p>
<h2 id="课程小结">课程小结</h2>
<p>最后，我们做一下课程小结。通过今天的课程，我希望你知道：</p>
<ol>
<li>二叉树的三种遍历方式：前序遍历、中序遍历与后序遍历，它们主要是依据根节点的位置划分出来的。</li>
<li>我们掌握了表达式与其对应的表达式树的对应关系。</li>
<li>表达式树的后续遍历结果，就等于原表达式的值。这种特性，给我们设计表达式求值程序，提供了思维方面的指导。</li>
</ol>
<p>好了，今天的课程就到这里结束了。真的想跟你再说一次“我们下期见“，可送君千里，终有一别。初航我带你，远航靠自己，我是海贼胡船长，我们江湖再见。</p>
<blockquote>
<p>参考代码</p>
</blockquote>
<p>/*************************************************************************</p>
<p>&gt; File Name: calc.cpp</p>
<p>&gt; Author: hug</p>
<p>&gt; Created Time: 五 3/27 22:13:04 2020</p>
<p>************************************************************************/</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#define INF 0x3f3f3f3f</p>
<p>/*</p>
<p>* 计算表达式 str 从 l 到 r 位置的值</p>
<p>* */</p>
<p>int calc(const char *str, int l, int r) {</p>
<p>/*</p>
<p>* pos : 根节点运算符的位置，初始化为 -1</p>
<p>* priority : 根节点运算符的权重</p>
<p>* temp : 由括号产生的额外权重</p>
<p>* */</p>
<p>int pos = -1, priority = INF - 1, temp = 0;</p>
<p>for (int i = l; i &lt;= r; i++) {</p>
<p>int cur_priority = INF;</p>
<p>switch (str[i]) {</p>
<p>case &lsquo;(&rsquo;: temp += 100; break;</p>
<p>case &lsquo;)&rsquo;: temp -= 100; break;</p>
<p>case &lsquo;+&rsquo;:</p>
<p>case &lsquo;-&rsquo;: cur_priority = 1 + temp;</p>
<p>case &lsquo;*&rsquo;:</p>
<p>case &lsquo;/&rsquo;: cur_priority = 2 + temp;</p>
<p>default: break;</p>
<p>}</p>
<p>/*</p>
<p>* cur_priority : 当前运算符的优先级</p>
<p>* 更新区间内最低优先级的运算符的位置</p>
<p>* */</p>
<p>if (cur_priority &lt;= priority) {</p>
<p>pos = i;</p>
<p>priority = cur_priority;</p>
<p>}</p>
<p>}</p>
<p>/*</p>
<p>* 如果 pos == -1，说明这一段表达式中没有运算符</p>
<p>* 说明，这一段表达式中只有数字，也就是递归到了树的叶子结点</p>
<p>* */</p>
<p>if (pos == -1) {</p>
<p>int num = 0;</p>
<p>for (int i = l; i &lt;= r; i++) {</p>
<p>if (str[i] &lt; &lsquo;0&rsquo; || str[i] &gt;= &lsquo;9&rsquo;) continue;</p>
<p>num = num * 10 + (str[i] - &lsquo;0&rsquo;);</p>
<p>}</p>
<p>return num;</p>
<p>}</p>
<p>/*</p>
<p>* 递归计算得到运算符左边及右边表达式的值</p>
<p>* 再根据当前运算符，得到当前表达式的值</p>
<p>* */</p>
<p>int a = calc(str, l, pos - 1);</p>
<p>int b = calc(str, pos + 1, r);</p>
<p>switch (str[pos]) {</p>
<p>case &lsquo;+&rsquo;: return a + b;</p>
<p>case &lsquo;-&rsquo;: return a - b;</p>
<p>case &lsquo;*&rsquo;: return a * b;</p>
<p>case &lsquo;/&rsquo;: return a / b;</p>
<p>}</p>
<p>return 0;</p>
<p>}</p>
<p>int get_val(const char *str) {</p>
<p>return calc(str, 0, strlen(str) - 1);</p>
<p>}</p>
<p>int main() {</p>
<p>char str[1000];</p>
<p>while (scanf(&quot;%[^\n]&quot;, str) != EOF) {</p>
<p>getchar();</p>
<p>printf(&quot;%s = %d\n&quot;, str, get_val(str));</p>
<p>}</p>
<p>return 0;</p>
<p>}</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content"></span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        10100-01-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E4%BA%BA%E4%BA%BA%E9%83%BD%E8%83%BD%E5%AD%A6%E4%BC%9A%E7%9A%84%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E8%AF%BE/">人人都能学会的编程入门课</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E9%9D%A2%E8%AF%9538%E8%AE%B2/30__%E5%AE%89%E5%85%A8%E6%80%A7%E6%9E%B6%E6%9E%84%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%98%AF%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E9%94%85/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">30__安全性架构：为什么说用户密码泄漏是程序员的锅？</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4/%E5%B7%A6%E8%80%B3%E5%90%AC%E9%A3%8E/30__%E7%BC%96%E7%A8%8B%E8%8C%83%E5%BC%8F%E6%B8%B8%E8%AE%B01-_%E8%B5%B7%E6%BA%90/">
            <span class="next-text nav-default">30__编程范式游记（1）-_起源</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2024 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script src="/lib/highlight/highlight.pack.js?v=20171001"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-FVZ07KBD4X"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-FVZ07KBD4X');
        }
      </script>






</body>
</html>
